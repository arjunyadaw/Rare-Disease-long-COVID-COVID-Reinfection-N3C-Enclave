

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    Covid_cohort_final=Input(rid="ri.foundry.main.dataset.7eb11610-f14d-4ceb-9ed1-b0651a3ab75d")
)
SELECT person_id, COVID_first_poslab_or_diagnosis_date
FROM Covid_cohort_final

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.563cf2e4-5174-4e7c-bd09-264a517f9773"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Rare surgical cardiac disease has no ICD10 code mapping and only single SNOMED code was matched which was excluded due to phynotype exclusion (no mapping)
SELECT *
FROM concept

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.8b912b21-7c8b-413d-9343-b5c63f2b3ab3"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for " " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED'  and concept_code in ('721719006', '208061000119101', '276526002', '235967003', '236015007', '254615000', '1228875006', '197808006', '1187508009', '1196885009', '473418001', '236017004', '690751000119102', '86422009', '690761000119100')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.b23b4258-2902-43c9-8219-2893207bf69b"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_abdominal_surgical_diseases=Input(rid="ri.foundry.main.dataset.8b912b21-7c8b-413d-9343-b5c63f2b3ab3")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_abdominal_surgical_diseases A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.ee05d8d3-8194-428c-8d50-546ae186c19b"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_abdominal_surgical_diseases_data=Input(rid="ri.foundry.main.dataset.b23b4258-2902-43c9-8219-2893207bf69b")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('K66.2') 

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_abdominal_surgical_diseases_data
) as rare_abdominal_surgical_diseases_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.6a8d5f75-3675-438b-943b-e17d1c04266c"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "rare_bone_diseases " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('719046005', '702342007', '724147004', '2391001', '42725006', '14870002', '254061001', '86268005', '720416007', '66758006', '389167007', '718559000', '254090007', '389162001', '20756002', '16583001000119104', '302211000119104', '1076951000119102', '1076971000119106', '302181000119103', '302221000119106', '302171000119101', '302191000119100', '1076931000119108', '16583041000119102', '302291000119108', '1076941000119104', '1076961000119100', '302261000119101', '302301000119109', '302251000119103', '302271000119107', '1076921000119105', '75930001', '720984008', '441809006', '389263004', '725141006', '254055004', '725142004', '717264003', '237889002', '1229999001', '725165009', '1264041000', '725050005', '783789002', '715487005', '90505000', '725166005', '782782004', '1229979007', '818966007', '818965006', '203476003', '203478002', '254125009', '771301002', '50123005', '15717401000119103', '15717441000119101', '15717361000119107', '15717521000119106', '389237009', '880067009', '732249002', '254054000', '715470008', '765761009', '782914000', '389165004', '778067002', '254113006', '720599002', '74928006', '389272007', '725104005', '389273002', '30174008', '254083002', '715631005', '398958000', '720851007', '782882009', '62501005', '763134002', '307607001', '113071000119101', '113081000119103', '725417001', '65976001', '719471002', '389199001', '764942005', '1228858000', '766874001', '732248005', '205506004', '720754008', '725099009', '36601008', '254135003', '254134004', '720753002', '720826006', '721082002', '715524004', '254099008', '709490002', '389216001', '58561002', '720598005', '82699004', '722433005', '254123002', '205480005', '715861004', '783165001', '765204000', '722434004', '733457006', '720863002', '254132000', '718099006', '721975004', '733416004', '715657008', '254153009', '1263445009', '55166000', '715899006', '82236004', '778008009', '17144009', '699251001', '76098004', '424286001', '720958002', '62803002', '1230021007', '28557005', '389264005', '1003427004', '725904009', '254116003', '389214003', '715568002', '717823001', '723827003', '77542002', '389261002', '63122002', '716189005', '726081005', '782781006', '721148005', '1197494003', '59763006', '9723006', '205483007', '205468002', '190859005', '237888005', '1217213004', '1231179003', '24752008', '55236002', '367489004', '724226009', '238867003', '1231182008', '75049004', '733418003', '238866007', '238861002', '240156000', '268025003', '203389008', '82837002', '53974002', '1172898008', '111304003', '254096001', '38494008', '764956007', '763778003', '63387002', '1393001', '17818006', '93132001', '719409004', '719404009', '721973006', '1169364005', '46041001', '109419009', '1003431005', '1003432003', '33410002', '726029005', '13449007', '16467301000119103', '16467261000119106', '16466741000119102', '16466581000119101', '16466821000119102', '1197053003', '719397009', '1010609002', '715652002', '205481009', '254085009', '24629003', '770909004', '7720002', '29248006', '389163006', '254084008', '724146008', '733419006', '717221005', '724145007', '22764001', '723404002', '1208348002', '725461009', '770564004', '770565003', '724141003', '715482004', '715670004', '389159004', '783723003', '307691000119108', '109714003', '307771000119103', '1222676004', '766992008', '719688002', '719689005', '766717008', '768935003', '313339007', '715673002', '715672007', '715674008', '766750008', '763893008', '716742001', '1179299005', '715218009', '773331001', '33979003', '203375003', '203374004', '203376002', '1255268002', '708672004', '725164008', '254068007', '722107005', '870320009', '448038004', '448039007', '315151000119101', '315161000119104', '1078101000119102', '315171000119105', '315181000119108', '315191000119106', '726030000', '315211000119107', '315221000119100', '1078091000119107', '315231000119102', '315241000119106', '315251000119108', '448967000', '203408003', '203412009', '203407008', '203405000', '240184005', '203404001', '203409006', '203413004', '448040009', '203411002', '430506003', '722109008', '1234828008', '78314001', '7134007', '205496008', '86470003', '15552004', '722110003', '1003379004', '385482004', '254110009', '254111008', '1197018005', '385483009', '280159008', '279309008', '63890001', '64404003', '205497004', '254144002', '1231151009', '315801000119108', '699687003', '787408008', '254129003', '732954002', '773730002', '254121000', '254122007', '722113001', '254112001', '63810002', '109716001', '109715002', '254124008', '1237513008', '54036001', '42432003', '254060000', '1169363004', '1169362009', '88220006', '722127006', '722210007', '771338002', '773985008', '770761005', '1208987006', '702347001', '36517007', '1003460001', '787484007', '82725007', '719271000', '462471000124100', '462461000124107', '254065005', '1187303004', '22567005', '254058002', '719258003', '89647000', '27837003', '389239007', '1237412001', '715472000', '85487008', '56692003', '1003862001', '1003860009', '1003858007', '715505002', '770948004', '773404000', '95243004', '1208934006', '254092004', '723995003', '29145002', '722114007', '17568006', '57917004', '787092009', '874931001', '766819001', '1217372003', '72922008', '726032008', '1279843003', '1197586007', '774155009', '719213009', '773625007', '763868006', '254114000', '1177175008', '722478008', '733468006', '10835311000119100', '10854141000119104', '26460006', '715862006', '203467005', '1076891000119100', '1076911000119103', '320851000119105', '320861000119107', '320871000119101', '320901000119101', '320891000119100', '1076881000119103', '1076901000119101', '320921000119105', '320931000119108', '320941000119104', '320971000119106', '320961000119100', '389161008', '716231009', '702351004', '254047006', '254079002', '703523004', '773302000', '719165004', '764460003', '773303005', '763885008', '773300008', '717330004', '782821004', '719166003', '719171005', '719172003', '719201004', '766821006', '702350003', '766820007', '718765003', '278713008', '718766002', '719203001', '718763005', '719204007', '718764004', '1228860003', '51952004', '719202006', '389160009', '773693005', '782912001', '782913006', '1269226006', '773304004', '719304005', '254078005', '719205008', '715653007', '763886009', '1197589000', '78675000', '1010668008', '1010664005', '783097004', '1010666007', '254097005', '723580007', '723578001', '29352008', '389157002', '389158007', '783004003', '723556008', '783003009', '25940001', '392559009', '254051008', '254052001', '715242008', '719041000', '716195006', '67049004', '72831007', '237894002', '237895001', '715532007', '254066006', '254131007', '782786001', '719837003', '1217228004', '782785002', '770603000', '389171005')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.5de53f71-26de-4993-badd-f8baa0ffea43"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_bone_diseases=Input(rid="ri.foundry.main.dataset.6a8d5f75-3675-438b-943b-e17d1c04266c")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_bone_diseases A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.d4f49b55-dd0b-46e9-b1b0-603e40a77c51"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_bone_diseases_data=Input(rid="ri.foundry.main.dataset.5de53f71-26de-4993-badd-f8baa0ffea43")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data 
    where condition_source_value in ('Q77.4', 'M61.1', 'Q77.5', 'Q77.1', 'Q78.0', 'M91.1', 'Q77.0', 'Q78.3', 'Q78.4', 'Q78.6', 'M87.2', 'M87.0', 'M92.7', 'M92.6', 'M85.4') 

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_bone_diseases_data
) as rare_bone_diseases_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.1b709083-93ab-4c8c-bcf5-de6528f025ee"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for " rare_cardiac_diseases" rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('1230097004', '1156821008', '418818005', '328851000119107', '1204167003', '1204129001', '725416005', '1141882007', '46619002', '233902009', '1142086006', '471890009', '253359006', '253348002', '715395008', '233855002', '1197418004', '766883006', '715865008', '233878008', '233913007', '1230303001', '60812006', '1186711002', '233901002', '472317002', '460500001', '721015008', '1142082008', '715560009', '723866006', '233908008', '771513008', '373905003', '447935001', '1172839002', '283645003', '55475008', '1187642008', '724173009', '715535009', '237292005', '1264003007', '233903004', '1142098001', '62377009', '8239009', '253543007', '253523001', '33258008', '52029003', '1279844009', '30884007', '20852007', '723993005', '698272007', '1230096008', '699256006', '719907006', '718104007', '715655000', '715626008', '719835006' )
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.542e0311-5846-46ab-b492-16fd1ad46e82"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_cardiac_diseases=Input(rid="ri.foundry.main.dataset.1b709083-93ab-4c8c-bcf5-de6528f025ee")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_cardiac_diseases A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.f92cb30f-37f6-4916-99d3-cf0cbdddb9ed"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_cardiac_diseases_data=Input(rid="ri.foundry.main.dataset.542e0311-5846-46ab-b492-16fd1ad46e82")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('O90.3', 'Q24.6', 'I42.5')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_cardiac_diseases_data
) as rare_cardiac_diseases_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.a0c1bf66-8ce8-499a-bd16-cf94b5785fbd"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_circulatory_system_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ( '723871004', '723872006', '1204216009', '1204212006', '1279832006', '1204198001', '1204186006', '1204184009', '1204182008', '1204181001', '1204180000', '1204178006', '720512007', '458432002', '720519003', '35386004', '1156027008', '1156029006', '230721009', '230720005', '715364001', '718602007', '68926002', '1197364005', '722020006', '403983000', '782773005', '45894003', '782724001', '702374000', '722930000', '42970005', '195229008', '724002003', '95501007', '247127002', '302879007', '302881009', '302880005', '230223008', '192772009', '8166000', '192770001', '48248005', '5511000124107', '192771002', '26954004', '3681008', '88922007', '89980009', '1078223005', '15742000', '21258007', '192760003', '70607008', '18322005', '192761004', '254786000', '770687001', '254787009')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.ab538050-61b3-47ca-b597-5da3e3d74b60"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_circulatory_system_disease=Input(rid="ri.foundry.main.dataset.a0c1bf66-8ce8-499a-bd16-cf94b5785fbd")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_circulatory_system_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.81219981-77fe-4ff6-8ad5-79a88ecd5bde"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_circulatory_system_disease_data=Input(rid="ri.foundry.main.dataset.ab538050-61b3-47ca-b597-5da3e3d74b60")
)
-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, There is no ICD-10 codes for it.

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM rare_circulatory_system_disease_data

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.d350fd9a-c533-43d9-bc89-dea998f41b30"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_developmental_defect_during_embryogenesis " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' 
and concept_code in ('770401007', '782669004', '770794008', '1229882003', '778007004', '14091009', '734030009', '773547003', '719047001', '771341006', '771439009', '20348002', '771340007', '719427001', '699254009', '719575008', '771477003', '719576009', '733518000', '1251450006', '719577000', '719578005', '1228890005', '733473000', '770760006', '719580004', '49013001', '734016004', '719582007', '719583002', '733519008', '764435003', '716683005', '719584008', '1229873009', '890116005', '56653005', '4199009', '4242009', '719597005', '764440006', '1229883008', '719599008', '719600006', '766766005', '1228844002', '699306003', '699305004', '771337007', '716515000', '719649004', '719650004', '773346008', '111311004', '1229891004', '763061004', '733520002', '787171006', '15841002', '767263007', '699311001', '699310000', '770756008', '719651000', '770754006', '719657001', '766816008', '719658006', '716387004', '719659003', '763062006', '54470008', '57514000', '890123006', '726705007', '778073001', '778000002', '770719004', '716456000', '717973004', '733622000', '733621007', '1237345002', '1234906009', '783092005', '1231281009', '783091003', '763683004', '725045004', '733625003', '770908007', '734028007', '726706008', '49024004', '719660008', '1251452003', '770793002', '70173007', '74008005', '719661007', '719665003', '719662000', '1003380001', '719663005', '719666002', '764703002', '726707004', '773326003', '719646006', '765140006', '716381003', '718188007', '719684000', '718615003', '719664004', '1229895008', '111309008', '764725008', '890128002', '77527000', '1228886008', '14921002', '718576001', '253679008', '311808009', '718575002', '449455000', '253333008', '718574003', '716099003', '449005003', '449563001', '253312004', '253401003', '253411005', '771264005', '719685004', '733068001', '253381001', '253392000', '719163006', '18166000', '79037006', '253405007', '253384009', '63340009', '718573009', '177504007', '722280000', '286391000119108', '38837006', '871621007', '472799000', '472800001', '715951007', '890221004', '720417003', '205260006', '403767009', '403768004', '733425005', '205258009', '70410008', '720418008', '773773006', '720419000', '720427009', '720429007', '720430002', '720408003', '721835008', '715427008', '720410001', '720412009', '720457000', '237610008', '720414005', '720458005', '720415006', '34748004', '720463009', '720464003', '722281001', '838370001', '783230008', '1003644007', '1003571002', '253172000', '204040004', '763797003', '722282008', '1208720000', '253139000', '205223007', '205222002', '1003509004', '205225000', '1003510009', '722004001', '204533007', '1003574005', '1010465001', '46965001', '1003507002', '1003704006', '253965002', '205221009', '86252004', '1003579000', '1010464002', '76074006', '1187130004', '1003519005', '1003582005', '876853002', '1003555002', '205817005', '722283003', '80651009', '403805009', '722285005', '720981000', '720979002', '239050000', '239010003', '770941005', '720980004', '734349003', '715342005', '720982007', '63702009', '707608003', '715404000', '702437000', '89369001', '717939009', '284811000119102', '15648321000119103', '15648281000119108', '253194008', '765750001', '720986005', '703525006', '720467005', '720468000', '720987001', '733116005', '253231007', '253232000', '783204009', '773770009', '720492008', '253310007', '459066006', '253706007', '450302005', '458039003', '460582006', '460930004', '448105006', '460923005', '460944005', '253633003', '32194006', '239013001', '720494009', '720495005', '720496006', '62964007', '763615003', '26201005', '448095003', '448842002', '448843007', '448975006', '449398002', '253649001', '447901004', '720498007', '733118006', '773583007', '723554006', '720500008', '720499004', '783231007', '1237365009', '1237366005', '720502000', '720501007', '237717004', '720511000', '31742004', '461423005', '461422000', '111289009', '871578006', '703336003', '703334000', '786039009', '726620005', '715217004', '720513002', '702441001', '28599006', '254243001', '51409009', '773769008', '720517001', '718577005', '205003000', '788869006', '204782009', '890099000', '890101007', '890102000', '890103005', '890104004', '890105003', '721649001', '721650001', '204544004', '838333005', '708059004', '448086006', '448087002', '717835002', '253902002', '79788002', '725145002', '253371000', '60732002', '763066009', '253373002', '15228007', '733626002', '715633008', '725149008', '702443003', '771512003', '1208614008', '7731005', '1255319004', '778069004', '771269000', '765331004', '718222000', '1187115008', '778070003', '890233009', '716232002', '726735000', '725434009', '773394007', '27025001', '770901001', '403780007', '719104003', '722376008', '715981004', '890237005', '417604002', '765755006', '77608001', '733093004', '234138005', '1258972007', '408537003', '5619004', '239011004', '1187644009', '1230295000', '81780002', '717859007', '239032007', '890220003', '403796005', '205828009', '717887003', '371189003', '890373001', '788875002', '890417008', '840458000', '840456001', '763735008', '204614006', '890404005', '890405006', '890401002', '371191006', '890403004', '15987031000119108', '15986111000119101', '840478008', '15670201000119103', '840481003', '840477003', '49813000', '890411009', '890409000', '1003324007', '897588005', '890353006', '890351008', '890285006', '890286007', '890347006', '1003442001', '253989009', '1148541006', '890364009', '717748005', '840492002', '717909004', '717749002', '890288008', '890361001', '890356003', '890357007', '897587000', '226707431000119102', '15667041000119103', '1003921006', '717745008', '1003337005', '1003339008', '1003583000', '717156002', '715985008', '763128009', '10170007', '717911008', '717913006', '715391004', '890180006', '778009001', '717914000', '717915004', '717920004', '4434006', '254784002', '717940006', '716180009', '720565000', '722296002', '21634003', '720567008', '715984007', '711153001', '720568003', '732956000', '732957009', '765761009', '389168002', '389169005', '63711009', '715722003', '720571006', '770406002', '720572004', '720573009', '253932005', '720574003', '720575002', '719098007', '717943008', '1169355000', '732961003', '717944002', '449821007', '764810000', '717945001', '70756004', '719097002', '725589005', '27272007', '233862006', '726031001', '733045005', '720601000', '720602007', '720603002', '1172633003', '733466005', '720600004', '239087008', '703533007', '720815000', '720605009', '720606005', '403770008', '720612000', '766881008', '703389002', '722382006', '722383001', '26445008', '726621009', '8301004', '1157156002', '254793001', '204052006', '722385008', '1222668001', '720633009', '763109002', '270513005', '204616008', '268197001', '204617004', '726669007', '205130008', '111341002', '715371006', '1237475006', '715990006', '253162003', '1216942009', '51780007', '703266007', '703267003', '6729006', '703268008', '763353000', '720635002', '41283003', '720855003', '720852000', '203985009', '203934001', '203948001', '203941007', '890422008', '47535005', '733034007', '703534001', '88659005', '77414002', '338486003', '17608003', '205718006', '716238003', '1281843005', '720640005', '232373003', '28724005', '720636001', '720851007', '62501005', '763134002', '720850008', '717761005', '702354007', '702357000', '719808002', '726733007', '718881004', '240551003', '773610007', '773329005', '717765001', '717261006', '238736006', '205265001', '205264002', '205267009', '205266000', '762586009', '1085291000119101', '762407001', '762587000', '762408006', '762588005', '253994009', '253993003', '762580003', '204620007', '762403002', '762581004', '762404008', '762582006', '78495000', '373643003', '719456001', '1187039001', '732247000', '6936002', '1085301000119100', '1119391009', '1119390005', '1085341000119103', '1085351000119101', '763130006', '403772000', '762660007', '66948001', '762409003', '762410008', '719466009', '719468005', '254000002', '762583001', '762405009', '762584007', '762406005', '762585008', '337471007', '783181006', '717771007', '719475006', '19290004', '450313008', '450312003', '450305007', '450304006', '360455002', '254774003', '42283001', '715528001', '21086008', '890433006', '890434000', '890432001', '717772000', '15182000', '10007009', '764455002', '56604005', '720639008', '768932000', '763133008', '204134008', '717785002', '763132003', '1179296003', '715771008', '776204008', '1197357008', '1197428008', '770625006', '1187640000', '92830003', '73699003', '60106004', '85081000', '762252001', '448120000', '448887003', '448809003', '447988007', '871647003', '871650000', '762253006', '448747000', '722992006', '890430009', '368851000119102', '89434002', '76842000', '24194000', '253996006', '783400002', '1119393007', '1119392002', '254001003', '253800006', '717756008', '763733001', '763727005', '1145543005', '55852007', '78018008', '763734007', '763728000', '1145544004', '1230025003', '205768003', '26146002', '21111006', '51500006', '41040004', '783742004', '763213001', '447702004', '447823004', '448920004', '447829000', '783773000', '253764008', '840512003', '51635000', '37221009', '38919006', '818949005', '371015003', '271020004', '91872004', '876847002', '876846006', '204658006', '205228003', '48301005', '1078301000119104', '1078291000119100', '1078271000119101', '371197005', '737217005', '205230001', '91885001', '205227008', '371199008', '765812004', '91889007', '766999004', '304931000119109', '16090091000119100', '304961000119101', '25559009', '849651000000105', '15582005', '767001002', '66489009', '204575008', '91898005', '91899002', '92969008', '302958006', '111317000', '91902004', '26595007', '59981001', '205749001', '767000001', '1078251000119105', '1078261000119107', '304971000119107', '39987008', '26865008', '91913001', '91914007', '270963009', '66345008', '1078331000119106', '1078321000119108', '1078311000119101', '3987009', '92976003', '1162915007', '734031008', '715733000', '307359001', '896999006', '54160000', '447876009', '69278003', '15986991000119108', '15986951000119103', '1003399005', '1231175009', '1231169000', '1231170004', '253907008', '702612001', '51442005', '37054000', '51118003', '7481002', '26179002', '75355004', '82821008', '52879001', '25896009', '1230062001', '360491009', '64981002', '23063005', '84296002', '63042009', '405752007', '1234908005', '275416002', '438583008', '77480004', '1197754004', '702611008', '719452004', '68539005', '702433001', '719102004', '722378009', '722379001', '36010004', '15665401000119102', '15665361000119106', '15665321000119101', '13624003', '15665721000119102', '51485001', '15988031000119109', '15987911000119102', '15986191000119105', '737579002', '44295002', '15988071000119107', '15987871000119100', '15986151000119100', '890222006', '890223001', '1201777007', '1258935001', '265798000', '1201776003', '1258936000', '205306000', '205821003', '1255322002', '204378009', '253720000', '11433004', '128555001', '128556000', '129582000', '128557009', '128558004', '253327004', '702360007', '93059006', '166071000000101', '59068006', '205064009', '205065005', '205066006', '15453007', '205067002', '23876003', '700284005', '253214000', '15937301000119106', '15937341000119108', '204667006', '699762000', '35266001', '56013008', '42324007', '58135005', '28682004', '36619004', '33257003', '66865009', '46907007', '890385009', '890379002', '3845008', '79552009', '725910009', '13568007', '15545001', '871597006', '762254000', '15670161000119108', '15670241000119101', '79120002', '897277000', '716660007', '60983006', '128063006', '1231176005', '205063003', '15671041000119100', '205838004', '720749004', '48763007', '91576008', '47028006', '47032000', '281899002', '1208346003', '840475006', '93255008', '93264003', '32659003', '34911001', '54682008', '361147005', '93290000', '719842006', '733030003', '10736711000119105', '715337002', '1251402007', '763747002', '128067007', '400965007', '1172594000', '1230239009', '767031008', '253544001', '448028009', '717260007', '840473004', '840474005', '254778000', '142201000119101', '403438007', '270516002', '703193000', '1137561000', '890370003', '83714006', '721880009', '733453005', '429753001', '762295002', '18735004', '1172589000', '205371009', '205372002', '205369009', '253945009', '205370005', '205373007', '128065004', '763316006', '312005008', '286071000119109', '1519002', '718610008', '782720005', '715463008', '718609003', '718608006', '718606005', '718605009', '718611007', '775907000', '330041000119103', '128062001', '447821002', '1222669009', '707711006', '1177173001', '782689003', '55379003', '890394003', '890388006', '268187005', '45142002', '1268409009', '271432005', '818951009', '767032001', '47082005', '1857005', '95479005', '707713009', '18620009', '715201005', '725101002', '361146001', '128066003', '18546004', '62335009', '449135007', '82458004', '702644002', '67278007', '36233006', '1234910007', '8712002', '472801002', '759941000000101', '7169009', '41514002', '35742006', '87318008', '9941009', '275376007', '32735002', '192008', '6267005', '54069001', '58392004', '59721007', '27648007', '276700005', '371076006', '786041005', '93397004', '93398009', '93399001', '93402000', '93403005', '93404004', '93405003', '93406002', '93408001', '93409009', '93410004', '93411000', '93412007', '73893000', '720394008', '447851008', '15135007', '142191000119104', '204354004', '716280004', '277644009', '204482005', '1260142000', '1078181000119105', '1078171000119107', '403556005', '205385004', '205304002', '268264007', '765206003', '205382001', '205387007', '205299003', '720746006', '720747002', '720748007', '74218008', '373092008', '373094009', '373095005', '373096006', '461425003', '461424004', '461345005', '253724009', '253723003', '253710005', '253326008', '83799000', '732251003', '784344009', '449436000', '449596004', '309776008', '429681000124103', '58037000', '732248005', '720752007', '715991005', '763665007', '254093009', '702362004', '773622005', '1217229007', '720755009', '720756005', '763320005', '715421009', '720757001', '725100001', '725098001', '784350004', '720812002', '773332008', '720816004', '720817008', '763684005', '1269224009', '720818003', '720813007', '715422002', '253269002', '447289007', '446657003', '722381004', '76304001', '770409009', '17827007', '702361006', '725096002', '204102004', '764950001', '763686007', '239037001', '413936007', '277807007', '720819006', '703528008', '784349004', '732261005', '707530009', '840448004', '733094005', '14447001', '203957007', '721084001', '721087008', '715527006', '716245003', '702423009', '721085000', '721086004', '124214007', '124220008', '440624006', '439258003', '40354009', '721158009', '270889005', '82959004', '733194007', '721089006', '721090002', '239022000', '721091003', '782916003', '771472009', '787093004', '721092005', '253514004', '716020005', '721094006', '721095007', '1217373008', '703298001', '715314008', '719451006', '253851000', '62192003', '51060001', '71464000', '763755009', '719450007', '733521003', '770629000', '764696007', '734029004', '764524005', '770905005', '773325004', '447700007', '1208482007', '897570002', '715575001', '773396009', '720515009', '765171002', '897564008', '722429003', '719686003', '718687003', '770902008', '763527007', '770410004', '766050000', '732259001', '770411000', '717633007', '763528002', '782673001', '718688008', '782674007', '763529005', '763530000', '205255007', '718689000', '764447009', '764454003', '764459008', '766051001', '782676009', '766052008', '766053003', '764500002', '764512003', '764518004', '763272003', '764519007', '763273008', '763274002', '722430008', '763275001', '763276000', '763277009', '897507003', '764520001', '773670004', '8634009', '253353007', '447666009', '449428009', '449492000', '449587004', '728371000000102', '728381000000100', '728391000000103', '728401000000100', '447667000', '449440009', '449441008', '448066007', '447962009', '448320008', '449594001', '449593007', '449429001', '449595000', '274947007', '719021005', '768843007', '782940006', '39401000', '702418009', '1236845001', '719800009', '253402005', '447284002', '871599009', '762251008', '871601006', '69015003', '7601009', '722431007', '50749006', '360422007', '10835661000119109', '840505007', '722432000', '699867001', '2593002', '60680007', '733070005', '778005007', '423462008', '239025003', '1179301003', '783619003', '733038005', '733050004', '231719009', '1208338004', '186833000', '4359001', '266125005', '46235002', '770431001', '716107009', '1172593006', '1169356004', '1187042007', '721200000', '703508009', '447915002', '449158005', '17394001', '448074008', '770432008', '770433003', '732953008', '1279835008', '734017008', '239024004', '771335004', '734018003', '721208007', '720856002', '239035009', '239015008', '239006001', '715576000', '39788007', '771177009', '771178004', '445928005', '702417004', '700057001', '890202007', '773768000', '733049004', '764521002', '723309006', '253795001', '230792007', '446940004', '447232008', '1222666002', '1208480004', '239112008', '733031004', '766870005', '80773006', '204659003', '721161005', '46760003', '55709000', '1260203008', '79303006', '1230270001', '61758007', '20815007', '782937006', '783774006', '29938001', '10375008', '771179007', '782949007', '763278004', '763279007', '783061008', '771515001', '733417008', '723333000', '723336008', '204351007', '253175003', '770435005', '722493007', '1230016009', '717192003', '253864004', '716773002', '1208478005', '253789002', '763691008', '726708009', '718552009', '253168004', '233858000', '770900000', '773278003', '1179298002', '1162864000', '1172636006', '725030006', '766927009', '764965000', '1285021005', '30575002', '774070008', '702431004', '205026007', '716706009', '13280000', '1230098009', '728471000000108', '448575000', '205788004', '65986000', '254249002', '254250002', '276701009', '716005004', '1220575002', '897278005', '897279002', '70065001', '718228001', '62110005', '254251003', '715197005', '254254006', '66351003', '17231009', '715223009', '38323006', '1237179007', '36025004', '715474004', '720952001', '783156008', '720953006', '720954000', '720955004', '782758009', '73371000119103', '773750003', '1186709006', '312214005', '239056006', '253364005', '720957007', '707234001', '10567003', '613003', '716709002', '716708005', '52616002', '239020008', '718848000', '1177166006', '773628009', '725029001', '716108004', '1208344000', '702432006', '721296004', '111502003', '443379009', '1186730002', '721297008', '716198008', '721843003', '89409002', '782690007', '722450007', '773749003', '702367005', '268243008', '733037000', '253176002', '716008002', '719687007', '722449007', '1222670005', '782722002', '717813005', '1172696009', '715644000', '717814004', '297257004', '716024001', '717822006', '716096005', '232065000', '716022002', '716006003', '722451006', '93466004', '1515008', '205800003', '69408002', '717824007', '32985001', '239012006', '774204006', '763186006', '722452004', '719395001', '719973009', '1197057002', '7903009', '721008000', '771180005', '702425002', '35031005', '716089008', '766032007', '716090004', '55821006', '721009008', '783738002', '721014007', '721010003', '721013001', '8757006', '85641006', '11701009', '697962004', '733046006', '726722009', '699420006', '771440006', '22471005', '56155002', '5300004', '722453009', '234146006', '771149000', '448081001', '449016005', '449014008', '449015009', '36631002', '717003001', '239055005', '1197033002', '399889006', '400040008', '771239007', '721147000', '54209007', '17761000119109', '783737007', '721221000', '721223002', '721222007', '417658006', '93556005', '716091000', '715434005', '30915001', '771146007', '890346002', '19092004', '783159001', '707276009', '18792003', '773733000', '732928005', '721227001', '238870004', '86443005', '240554006', '253158009', '302882002', '773280009', '721229003', '732926009', '721015008', '721231007', '721232000', '15539009', '1237349008', '785726009', '721233005', '33982008', '773667003', '724284005', '721836009', '765155002', '765154003', '239021007', '236796004', '773665006', '239026002', '773553003', '239007005', '721845005', '702379005', '722284009', '860820000', '449270002', '773673002', '253832006', '62067003', '205174005', '205175006', '205176007', '205177003', '205178008', '724281002', '723365002', '763658004', '703386009', '763404001', '235916001', '733097003', '732950006', '783551005', '206538000', '1234823004', '253797009', '720514008', '204702007', '771185000', '359824007', '253995005', '254002005', '763754008', '763498007', '763753002', '763499004', '367520004', '715430001', '1010660001', '1260450002', '724226009', '782886007', '35850006', '429671000124101', '1149232006', '459173004', '4107000', '254016000', '254017009', '254018004', '254019007', '203927003', '203928008', '763741001', '1217382002', '764861005', '763744009', '725906006', '1186729007', '782753000', '412787009', '773581009', '722454003', '722456001', '721146009', '773416006', '782736007', '773552008', '722455002', '773621003', '1254652005', '1208746001', '764959000', '763350002', '774102003', '763742008', '1177167002', '770750002', '771077007', '763743003', '763745005', '447665008', '447701006', '871625003', '253683008', '253682003', '253681005', '472103001', '472102006', '472101004', '1003421003', '720009004', '253164002', '28065000', '702384004', '1285323003', '204153003', '204154009', '715654001', '766708008', '770542008', '723332005', '1231746006', '771147003', '771234002', '766709000', '763748007', '717262004', '734026006', '763317002', '718691008', '1263461006', '1263449003', '715406003', '718135001', '766934006', '253337009', '253336000', '722006004', '1237226008', '709105005', '715438008', '57918009', '61367005', '771470001', '253796000', '75979009', '721584005', '1216940001', '773626008', '716997004', '721847002', '733418003', '716998009', '721862000', '721873007', '716999001', '721874001', '403838000', '1149069001', '68764005', '253675002', '128563000', '313426007', '770907002', '722027009', '722031003', '715989002', '722032005', '205686009', '205687000', '716112005', '711156009', '763774001', '723830005', '724208006', '239059004', '764957003', '724207001', '205698004', '1217225001', '5601008', '109478007', '717338006', '726083008', '30278004', '702447002', '716996008', '1251453008', '41069008', '724178000', '1003440009', '306949002', '306950002', '306951003', '306953000', '703199001', '1142095003', '266126006', '82323002', '827006', '230152000', '186842007', '1142031005', '1142092000', '230563005', '764955006', '232059000', '762907005', '762912006', '762909008', '762913001', '445436005', '719429003', '438504004', '41656005', '10406007', '715565004', '1229876001', '715418007', '715419004', '715420005', '719400000', '1237470001', '1237342004', '719402008', '1172705006', '60192008', '773672007', '719408007', '778026007', '400128006', '735421004', '23817003', '56212008', '1003437009', '1003438004', '764437006', '716106000', '721972001', '1208985003', '52298009', '237608006', '770560008', '718759003', '717977003', '715780008', '718719001', '718720007', '785307003', '715819005', '715820004', '715821000', '785306007', '715822007', '204790009', '773426004', '721182004', '1010709006', '76744005', '61900003', '59352006', '42808000', '44444001', '733454004', '47206001', '766249007', '770561007', '79385002', '17771000119103', '721974000', '716007007', '203987001', '203936004', '203950009', '203943005', '1003445004', '721976003', '721977007', '204319006', '238799002', '721979005', '721978002', '721083007', '1204421005', '716023007', '763773007', '783089006', '1187642008', '1187304005', '722033000', '69381005', '890366006', '205262003', '205261005', '15672241000119102', '15672201000119104', '253933000', '15671721000119108', '15671681000119102', '205343003', '205342008', '9740002', '773282001', '723366001', '723367005', '722463001', '1229946007', '763795006', '406477003', '722459008', '719398004', '461331004', '718679004', '773557002', '1216943004', '711543008', '703539006', '1169358003', '449824004', '782780007', '733062000', '732262003', '73284007', '722380003', '838441009', '765138001', '297225000', '770562000', '770563005', '773299000', '766237006', '715735007', '782691006', '782692004', '766238001', '766239009', '766240006', '783735004', '722458000', '1162832007', '717705004', '715441004', '702407009', '722461004', '29076005', '702816000', '699700006', '232384005', '722034006', '722035007', '253884000', '253885004', '85901000', '253781004', '703536004', '700063005', '722036008', '1260143005', '733522005', '716199000', '722037004', '732263008', '290006', '444860006', '1260095004', '724170007', '724144006', '1179283004', '723403008', '765758008', '770655004', '719380003', '719394002', '733472005', '733092009', '733604003', '719377004', '719378009', '719379001', '703369003', '1167375003', '1254650002', '1279889005', '721903007', '1254651003', '234638009', '773305003', '723304001', '771074000', '715462003', '716166002', '721881008', '1197215004', '1187114007', '723405001', '1230344000', '717222003', '721878003', '720010009', '721879006', '724140002', '724139004', '866053004', '403557001', '723383005', '40291001', '1156317007', '838538002', '253148005', '66038001', '715440003', '715523005', '1237514002', '871652008', '1228859008', '715533002', '838539005', '766987006', '1779005', '724137002', '770566002', '766716004', '787411009', '771072001', '724098008', '710008008', '109436001', '719843001', '715628009', '716169009', '783149002', '302960008', '710019006', '764461004', '764463001', '764466009', '764619001', '764621006', '764622004', '829974003', '764624003', '764625002', '764623009', '764627005', '764628000', '764629008', '764630003', '717335009', '764989007', '710010005', '700056005', '703535000', '890118006', '724097003', '721583004', '1187113001', '787407003', '1177081002', '81604003', '716111003', '1208725005', '723409007', '785303004', '773643006', '253722008', '95472001', '111306001', '254782003', '62628008', '699301008', '277950001', '773584001', '1251451005', '723406000', '253114009', '724644005', '735749005', '4061000119104', '699316006', '733065003', '239084001', '35520007', '764995008', '22199006', '445257004', '716775009', '65455002', '1230269002', '723411003', '253107007', '716170005', '1237462006', '254221009', '238874008', '724278007', '703186004', '724092009', '766751007', '77817004', '1217381009', '1222710008', '725908007', '715344006', '715316005', '401046009', '1237228009', '766753005', '770665005', '782694003', '770666006', '764996009', '764997000', '723442008', '728461000000101', '447933008', '703295003', '728481000000105', '703178004', '1163260008', '1163259003', '1231181001', '205824006', '783143001', '723444009', '449534004', '782879004', '254003000', '236533008', '782783009', '1010685005', '716174001', '403554008', '722056009', '699754008', '38215007', '699300009', '763830009', '722061006', '770944002', '722019000', '722055008', '722062004', '403764002', '239019002', '403762003', '763828007', '239028001', '722063009', '771442003', '699297004', '699298009', '722065002', '41962002', '18417009', '719944006', '721017000', '715483009', '30526003', '196864001', '196856007', '1542009', '80880002', '1003381002', '703403003', '715484003', '782945001', '81771002', '74307005', '1177179002', '1231206001', '239030004', '239031000', '763833006', '722075004', '718681002', '763834000', '763835004', '763837007', '722105002', '722106001', '718680001', '21877004', '722108000', '733064004', '722117000', '1237343009', '763860004', '441944007', '722122000', '205292007', '205291000', '763861000', '722132007', '722201004', '1172889005', '56677004', '719020006', '722202006', '1222646006', '722203001', '1222660008', '253391007', '254007004', '253731008', '122811000119101', '447939007', '447827003', '447664007', '447860000', '447861001', '59070002', '45482001', '773497001', '718216009', '253799007', '717757004', '1187305006', '719044008', '702412005', '722211006', '724070005', '766719006', '770668007', '715736008', '766720000', '770669004', '770670003', '766721001', '783718003', '724069009', '1228871002', '1236843008', '763863002', '717042001', '870286003', '870287007', '870284000', '870285004', '783140003', '719299009', '719298001', '725138002', '401138005', '281587000', '204306007', '43248007', '724068001', '31080005', '765325002', '722231005', '724067006', '716191002', '783011004', '1264081007', '721970009', '702358005', '204318003', '253658008', '448968005', '447772003', '449817000', '719139003', '1003877009', '1003916008', '1003918009', '703284009', '703286006', '723455009', '703285005', '723453002', '715431002', '715506001', '403781006', '1220594007', '723461007', '1222667006', '1230005002', '723451000', '771240009', '771013004', '702344008', '1217367007', '253733006', '1172899000', '771186004', '38371006', '733087007', '723446006', '715710001', '1208935007', '771336003', '716279002', '8641000119101', '724066002', '723448007', '782884005', '763821001', '783701002', '403856000', '403765001', '403545005', '763866005', '773279006', '715707008', '770946000', '253676001', '253677005', '609528003', '698765007', '724064004', '818963004', '1197212001', '1269233006', '703192005', '698837003', '702346005', '702356009', '89392001', '733088002', '253672004', '253674003', '253673009', '1172689007', '719140001', '1268904009', '1259826000', '1259726005', '764100007', '763617006', '419544009', '277656005', '717742006', '768939009', '715828006', '1216939003', '399947002', '1237413006', '302811004', '715529009', '1172900005', '719268008', '1172690003', '703291007', '23150001', '718227006', '765142003', '764739008', '447773008', '1003901005', '1003893000', '1003883007', '5187006', '236529001', '715867000', '733086003', '770591002', '719256004', '447838003', '447839006', '253590009', '253591008', '448155003', '448059006', '448060001', '253622001', '233718008', '784353002', '766976003', '251006007', '195000004', '251007003', '236530006', '95198001', '95218005', '1237421000', '1220568003', '253113003', '85589009', '783137003', '766765009', '205254006', '1268410004', '15667081000119108', '459619971000119103', '15667121000119105', '168648641000119107', '721882001', '721883006', '719162001', '723504000', '702413000', '703294004', '715471007', '718189004', '782942003', '446449009', '763891005', '699669001', '1172624000', '728491000000107', '447780005', '723503006', '703542000', '73119000', '57838006', '1010610007', '1172605003', '724001005', '725287006', '91442002', '85971001', '723999009', '715415005', '47507006', '448631009', '762908000', '762911004', '762910003', '762914007', '86997002', '111310003', '770595006', '726723004', '702345009', '763405000', '763406004', '778043005', '88154004', '765484001', '47017007', '23686004', '31325007', '13555004', '765485000', '765486004', '81678004', '765487008', '765488003', '765489006', '715983001', '60650002', '763407008', '1222659003', '48718006', '76520005', '770681000', '8793008', '765093009', '239009008', '69093006', '1003922004', '1003923009', '715986009', '253227001', '64190005', '231985001', '45582004', '277299009', '15069006', '3073006', '1003920007', '774150004', '203951008', '203944004', '83015004', '716094008', '239023005', '1197148005', '1208488006', '726629006', '721888002', '734173003', '721902002', '18899000', '715522000', '718095000', '716092007', '239018005', '722002002', '700062000', '448595006', '716337006', '418653000', '73381000119100', '715464002', '763867001', '787094005', '716243005', '253138008', '2625009', '449516003', '248845002', '36297009', '7611002', '723720008', '773400009', '1172629005', '1208727002', '778011005', '723676007', '1197591008', '773551001', '773419004', '783005002', '1208341008', '838540007', '722213009', '715216008', '41371000119100', '1279843003', '774155009', '1187277001', '726734001', '1237618009', '723998001', '1284851009', '726672000', '716193004', '721073008', '763631006', '721075001', '773556006', '719069008', '716230005', '1229943004', '439143004', '253721001', '109426009', '109425008', '50751005', '253370004', '253369000', '723973002', '68716001', '70978004', '1172632008', '733095006', '715428003', '204691002', '43929004', '401315004', '702416008', '86463003', '715987000', '75968004', '698851003', '763669001', '722209002', '1187278006', '723621000', '773623000', '763889002', '53318002', '203946002', '203954000', '268143001', '723612001', '403967000', '733033001', '726724005', '1172635005', '732927000', '723611008', '1162826002', '763717004', '1010642001', '253169007', '1187041000', '719305006', '723581006', '719306007', '716233007', '472845002', '723584003', '54008006', '71578002', '52604008', '723583009', '782167001', '733072002', '1187120008', '19886006', '766756002', '783096008', '204456001', '472782001', '472798008', '472802009', '711157000', '1187132007', '733606001', '204457005', '1230004003', '41878001', '897577004', '764106001', '445175006', '1162837001', '732955001', '1237577000', '1237344003', '735515000', '783553008', '783562005', '715442006', '783700001', '715723008', '715724002', '715725001', '719158007', '719159004', '763624007', '718761007', '778023004', '719161008', '718900002', '719160009', '239121009', '1169359006', '770788000', '725911008', '702312009', '1172628002', '771265006', '733067006', '719946008', '1172626003', '725140007', '778012003', '777998000', '719947004', '50658006', '702313004', '716249009', '762433009', '770945001', '726363000', '770663003', '9527009', '698849002', '764690001', '766755003', '715530004', '773281008', '36193003', '722476007', '73391000119102', '773554009', '716740009', '716192009', '253678000', '782951006', '203986005', '203935000', '203949009', '203942000', '733628001', '253118007', '771511005', '711407000', '771182002', '733117001', '723555007', '715531000', '764857004', '737581000', '1222708006', '74788000', '722477003', '771266007', '253732001', '24750000', '235640006', '1208998007', '724643004', '371045000', '5432003', '204762005', '8986002', '39719008', '205184006', '302957001', '205191009', '205187004', '205190005', '205188009', '205189001', '205204000', '302956005', '253961006', '423582009', '277810000', '38993008', '763620003', '719911000', '239036005', '766813000', '239014007', '818959006', '723551003', '871655005', '733066002', '719948009', '719949001', '205354008', '733456002', '719950001', '719951002', '66651005', '717157006', '205619006', '205620000', '717049005', '205623003', '205624009', '768927001', '205615000', '205616004', '768929003', '35111009', '234129008', '111319002', '7199000', '1187215002', '205684007', '254280007', '254281006', '38804009', '2829000', '719840003', '719844007', '700211007', '719910004', '69729007', '716110002', '253899000', '451030007', '716334004', '232057003', '514793471000119104', '232058008', '72645004', '717701008', '717702001', '57058008', '123665003', '5364006', '1372004', '719042007', '719043002', '733110004', '719845008', '79261008', '448078006', '448079003', '27742002', '763616002', '719823007', '204312002', '253515003', '764697003', '719824001', '719833004', '715952000', '47434006', '1010606009', '1010636000', '237918004', '1187247007', '232064001', '715215007', '111504002', '772224009', '702829000', '1186725001', '63119004', '726670008', '2884008', '715988005', '51626007', '763619009', '783703004', '772127009', '763618001', '79665007', '63247009', '719834005', '1187122000', '699275001', '718226002', '734022008', '719019000', '719819004', '1162839003', '770604006', '763460007', '766761000', '771148008', '1010630006', '719836007', '717223008', '1172697000', '71779008', '719018008', '719155005', '719157002', '719017003', '719811001', '719016007', '773587008', '719013004', '773274001', '783702009', '1237420004', '726727003', '765471005', '719825000', '719012009', '726732002', '719011002', '719010001', '718897009', '1255335006', '718905007', '718908009', '718909001', '718910006', '718911005', '718914002', '719009006', '719826004', '718845002', '719136005', '719138006', '719156006', '422437002', '719812008', '719810000', '1172692006', '763462004', '717632002', '719813003', '1197588008', '1255278004', '718849008', '718847005', '719817002', '719818007', '782877002', '1229872004', '766760004', '74398009', '38847009', '78317008', '403760006', '773418007', '733605002', '773307006', '699447001', '716248001' ) 
ORDER BY concept_name --DESC
--LIMIT 1600

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.377f7f97-7c2b-4eb3-9da0-cb1a91c4b91b"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_developmental_defect_during_embryogenesis=Input(rid="ri.foundry.main.dataset.d350fd9a-c533-43d9-bc89-dea998f41b30")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_developmental_defect_during_embryogenesis A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.873c0368-60b9-4f8b-9522-40f33f90af78"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_developmental_defect_during_embryogenesis_data=Input(rid="ri.foundry.main.dataset.377f7f97-7c2b-4eb3-9da0-cb1a91c4b91b")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('D82.1', 'Q99.2', 'E79.1', 'I78.0', 'Q98.5', 'Q82.3', 'Q23.4', 'Q86.0', 'P35.0', 'Q83.0', 'Q83.1', 'Q51.0', 'Q51.5', 'P37.1', 'P35.8', 'Q85.1', 'Q99.0', 'Q99.1', 'Q97.0', 'Q16.1', 'Q01.1', 'Q06.2', 'Q86.1', 'P35.1', 'Q72.4', 'Q06.0', 'Q04.1', 'Q04.4', 'Q33.2', 'Q22.1', 'Q23.0', 'Q24.4', 'Q21.4', 'Q76.1', 'Q72.1', 'Q71.2', 'Q71.1', 'Q72.2', 'Q72.0', 'Q71.0', 'Q39.2', 'Q44.2', 'Q55.5', 'Q64.3', 'Q72.5', 'Q71.4', 'Q71.5', 'Q72.6', 'Q69.1', 'Q13.3', 'Q12.3', 'Q43.7', 'Q27.1', 'Q22.4', 'Q64.0', 'Q26.2', 'Q26.3', 'Q12.2')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_developmental_defect_during_embryogenesis_data
) as rare_developmental_defect_during_embryogenesis_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.2f9fcdfd-f23d-4010-83eb-c64ba6fd12ff"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_disorder_due_to_toxic_effects " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('295125005', '290134002', '296486006', '291385005', '291992008', '295724001', '290699005', '295698000', '290677002', '297039006', '295702001', '290681002', '296322006', '296326009', '242261003', '216583009', '291261004', '216740001', '216780005', '216640006', '216729009', '216726002', '1145156006', '295124009', '1260191006', '1269177007', '89629006', '212737004', '27956007', '70328006', '296485005', '789291002', '45328004', '80471007', '297062008', '241816009', '426692001', '295722002', '723489005', '763740000', '47980004', '290544006', '296487002', '291386006', '297063003', '291993003', '295725000', '290700006', '295699008', '290678007', '297040008', '295703006', '290682009', '296323001', '296327000', '242824002', '290135001', '291263001', '49434001', '726613003', '1145155005', '212738009', '297037008', '295697005', '290676006', '297038003', '212739001', '295701008', '290680001', '212809004', '39640004', '789283006', '129666005', '77721001', '52866005', '22130008', '296321004', '296325008', '1148724006', '75017004', '420775008', '9982009', '24354007', '241761001', '12876009', '10385009', '32393008', '61288004', '765090007', '717125005', '241810003', '241808000', '217651002', '217652009', '217653004', '241805002', '217654005', '217656007', '217657003', '241807005', '241806001', '217659000', '217670007', '217660005', '241804003', '241809008', '217661009', '217662002', '242837004', '789286003', '789289005', '66207005', '72446009', '70842005', '67121008', '767299002', '78405005', '48152004', '1156340006', '51399001', '55623006', '239910001')
ORDER BY concept_name

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.50a79416-628f-43ba-9468-1464ab9caf22"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_disorder_due_to_toxic_effects=Input(rid="ri.foundry.main.dataset.2f9fcdfd-f23d-4010-83eb-c64ba6fd12ff")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM  rare_disorder_due_to_toxic_effects A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.d0890b78-2138-4332-945f-50b306cbf262"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_disorder_due_to_toxic_effects_data=Input(rid="ri.foundry.main.dataset.50a79416-628f-43ba-9468-1464ab9caf22")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('T56.0', 'T56.1', 'T66', 'T63.0', 'T63.2', 'T65.0', 'T51.1', 'T40.5')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_disorder_due_to_toxic_effects_data
) as rare_disorder_due_to_toxic_effects_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.7b09e8a3-4860-4192-b8e0-221d6c4f553c"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_endocrine_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('1003380001', '718715007', '86907008', '75659004', '766986002', '76715008', '237760008', '783243008', '763311001', '717044000', '1197746001', '770941005', '709075008', '724770001', '1269271003', '449731009', '449730005', '1217515007', '237687003', '1217517004', '771445001', '1197747005', '722375007', '788390005', '237614004', '733491005', '1220595008', '56823000', '702364003', '1197749008', '718182008', '237764004', '725462002', '722944006', '718690009', '783177006', '1230272009', '717333002', '1231283007', '700150001', '773728004', '773664005', '721088003', '609579009', '609580007', '609581006', '783741006', '783740007', '237733001', '45740001', '190492009', '778064009', '782917007', '33513003', '237696003', '1197489003', '703309000', '765326001', '703234002', '238078005', '763715007', '1217075009', '1186812001', '715343000', '15346004', '237885008', '773645004', '786037006', '725036000', '702375004', '1264565005', '725295005', '1279836009', '716743006', '715439000', '725035001', '718183003', '398796005', '238092004', '254962005', '819950002', '1260139006', '770631009', '267386008', '16424000', '45414006', '254960002', '715625007', '724385009', '237839005', '237838002', '255038009', '720940008', '715402001', '717898002', '716857003', '716338001', '783696009', '773726000', '720459002', '626004', '721235003', '275598004', '702378002', '86073008', '93559003', '721841001', '733113002', '773665006', '721842008', '773666007', '717895004', '724281002', '1255269005', '718194004', '717334008', '190470005', '783158009', '764960005', '408539000', '237651005', '237652003', '764959000', '1197592001', '758664007', '10736002', '89261000', '237824009', '1255271005', '722027009', '1220589007', '724179008', '38196001', '773989002', '238091006', '111307005', '75667007', '1197751007', '127012008', '112991000000101', '724176001', '237608006', '1229946007', '713189001', '722380003', '609562003', '609577006', '609578001', '237604008', '609570008', '609571007', '609572000', '609573005', '609574004', '609575003', '609576002', '1220596009', '1234831009', '724174003', '1197217007', '43019009', '724094005', '773987000', '771308008', '764999002', '722051004', '783549006', '785722006', '717269008', '722053001', '783719006', '722206009', '255039001', '783016009', '237682009', '783014007', '783616005', '609565001', '724067006', '237701005', '715668008', '783009008', '190502001', '783008000', '715727009', '425708006', '1260449002', '11244009', '83728000', '190471009', '267390005', '190472002', '1148694009', '1186863001', '237699005', '1197745002', '770680004', '89392001', '123760002', '703306007', '719275009', '1259747009', '782825008', '715868005', '702949005', '717792007', '58833000', '56090007', '42183005', '771262009', '237659007', '724555000', '33559001', '773663004', '1260240000', '1260241001', '297267009', '89024000', '13196008', '783556000', '237684005', '721069005', '766817004', '783098009', '721074002', '721072003', '763890006', '1229943004', '778046002', '253006001', '765143008', '237770005', '723579009', '254959007', '186270000', '716239006', '36102002', '70694009', '1285518004', '1285519007', '816067005', '789187001', '234533006', '771510006', '719826004', '237683004' )
ORDER BY concept_name

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.b0c94f35-fa3f-4930-8e6e-9efe9aa283d7"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_endocrine_disease=Input(rid="ri.foundry.main.dataset.7b09e8a3-4860-4192-b8e0-221d6c4f553c")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_endocrine_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.e248d5f8-4e5c-4ca0-b0bf-013d303502a8"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_endocrine_disease_data=Input(rid="ri.foundry.main.dataset.b0c94f35-fa3f-4930-8e6e-9efe9aa283d7")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('E24.1', 'E31.0', 'E23.2', 'E24.0', 'E22.0', 'A39.1', 'E35.1')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_endocrine_disease_data
) as rare_endocrine_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.03bc5ff8-5b3f-47c4-8b1d-c9564246748e"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_gastroenterologic_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('235724004', '344015141000119100', '289566561000119108', '235761008', '133421000119101', '143561000119108', '422470007', '360434004', '197150008', '72779005', '432990004', '204716002', '715866009', '235728001', '722288007', '1082761000119106', '783195009', '424567005', '720604008', '722386009', '471891000124101', '1217704000', '720507006', '716277000', '734019006', '1187194006', '1197738002', '785727000', '716665002', '235828008', '235829000', '235762001', '133411000119108', '143551000119106', '1279887007', '204739008', '75633002', '897594002', '1003398002', '897595001', '91210006', '773579007', '725591002', '253774006', '302952007', '27943000', '5388008', '722392003', '235729009', '204721004', '204808002', '24412005', '18805001', '204724007', '671131000124105', '722849002', '720820000', '720401009', '261409005', '301829006', '89030000', '51338006', '63924002', '67375008', '53954009', '24829000', '721609009', '235794006', '235730004', '1156815009', '235956004', '72900001', '1230314003', '771446000', '60876000', '717822006', '719972004', '63684002', '787410005', '261827001', '721608001', '721221000', '721223002', '721222007', '235831009', '763536006', '80018001', '715192004', '353821005', '1173999006', '426508001', '1186654001', '771333006', '1186721005', '234041004', '35151000119105', '1186652002', '197155003', '56661000', '715669000', '717186009', '733447005', '1156799009', '9273005', '1149069001', '204740005', '703535000', '890118006', '723496007', '2707005', '788986004', '788987008', '788988003', '788989006', '788990002', '788991003', '773662009', '206525008', '1156770004', '773397000', '722060007', '1220591004', '431874002', '397729009', '53633000', '54411001', '235961002', '35065006', '80761006', '19881001', '1222675000', '6124009', '770592009', '235760009', '770593004', '722847000', '717255008', '204741009', '716685003', '14534009', '78373000', '197001004', '235793000', '1222709003', '95447001', '95446005', '360428006', '427151002', '84193000', '703406006', '724540009', '61665008', '715952000', '448211002', '724276006')
ORDER BY concept_name

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.35a35a69-a740-49ef-9526-4fd239ee2f5a"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_gastroenterologic_disease=Input(rid="ri.foundry.main.dataset.03bc5ff8-5b3f-47c4-8b1d-c9564246748e")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_gastroenterologic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.e298ae32-b94a-4c36-b066-8c78da4c9335"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_gastroenterologic_disease_data=Input(rid="ri.foundry.main.dataset.35a35a69-a740-49ef-9526-4fd239ee2f5a")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('K22.0', 'Q45.2', 'K62.7', 'E73.0', 'K52.3')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_gastroenterologic_disease_data
) as rare_gastroenterologic_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.6282d1f1-fb4d-4fd6-a4e8-113c2d31c6b8"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_genetic_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ( '716698007', '716697002', '766929007')
ORDER BY concept_name

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.eedea89e-395a-4b5e-b683-00dc733ba0bd"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_genetic_disease=Input(rid="ri.foundry.main.dataset.6282d1f1-fb4d-4fd6-a4e8-113c2d31c6b8")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_genetic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.vector.main.execute.2dbb75f2-94db-4fb6-8bd7-a6955bbbe9e5"),
    rare_genetic_disease_data=Input(rid="ri.foundry.main.dataset.eedea89e-395a-4b5e-b683-00dc733ba0bd")
)
-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates. There is no ICD-10 codes for it.

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM rare_genetic_disease_data ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.21f3580b-5cb3-4636-af6b-b3651d423f96"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_gynecologic_or_obstetric_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('881637171000119102', '35543003', '53913001', '717699008', '50993001', '233651009', '717700009', '17829005', '237117005', '770436006', '766927009', '414464311000119100', '638862541000119108', '95605009', '1269273000', '1169366007', '41114007', '129635004', '16740451000119109', '765182005', '67359005', '46764007', '198986005', '1237344003', '237445009', '417006004', '13404009', '707250009')
ORDER BY concept_name

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.19eb1760-768f-41ff-af60-688e2490d299"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_gynecologic_or_obstetric_disease=Input(rid="ri.foundry.main.dataset.21f3580b-5cb3-4636-af6b-b3651d423f96")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_gynecologic_or_obstetric_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.c5fc7003-adf2-4ea4-945d-cda6b448b1b0"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_gynecologic_or_obstetric_disease_data=Input(rid="ri.foundry.main.dataset.19eb1760-768f-41ff-af60-688e2490d299")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('N98.1', 'O88.1')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_gynecologic_or_obstetric_disease_data
) as rare_gynecologic_or_obstetric_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.39c95734-2077-45fa-b24b-4d5c67aee030"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_hematologic_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and  concept_code in ('71988008', '191298004', '33820001', '307343001', '95843009', '295315008', '1217409009', '725157006', '439007008', '234451005', '444108000', '1153415008', '1153413001', '720465002', '765748009', '5967006', '89810003', '36467003', '86242003', '85422000', '68913001', '234385007', '734349003', '715342005', '191187006', '66055002', '720982007', '127213008', '127214002', '718716008', '438476003', '778006008', '95842004', '720521008', '783202008', '1187252002', '767497003', '767499000', '767498008', '783766005', '717050005', '54569005', '79592006', '47084006', '65959000', '191189009', '15326009', '269175006', '718196002', '86715000', '27080008', '111572002', '782934004', '783194008', '725105006', '207036003', '714460000', '1259049004', '399945005', '127055007', '127056008', '13172003', '770407006', '715559004', '154818001', '716746003', '716336002', '718721006', '111571009', '1208617001', '62578003', '234361004', '59548005', '68870007', '26409005', '719453009', '441134009', '234444001', '234445000', '426199009', '439145006', '234395000', '267550008', '234396004', '717407006', '1172901009', '1156468009', '211782003', '211976006', '211844000', '211783008', '211913005', '211780006', '211784002', '211711000', '211781005', '211706002', '211911007', '211703005', '211842001', '762471001', '770615001', '211975005', '211841008', '211709009', '211785001', '735509000', '762467004', '762483004', '211978007', '211977002', '762484005', '211712007', '211707006', '211912000', '735503004', '211708001', '211846003', '211845004', '770781006', '211979004', '211909003', '211974009', '762474009', '211843006', '762477002', '211914004', '725291001', '124178006', '124128009', '715526002', '234388009', '16360009', '76336008', '373421000', '716682000', '309742004', '127060006', '18323000', '441322009', '773422002', '400131007', '73190000', '23371004', '109994006', '75331009', '1148862002', '88540000', '33169001', '45963004', '17342003', '127065001', '725034002', '127066000', '717254007', '720950009', '783256001', '22933009', '48250002', '788944005', '36799008', '237926007', '51720005', '86225009', '44206008', '1239381000000101', '1239371000000103', '95605009', '5300004', '1148910003', '119691000119106', '51053007', '234386008', '119701000119106', '66729008', '234392002', '25065001', '447117006', '48553001', '234387004', '74912001', '782880001', '1148897000', '1148899002', '417425009', '416180004', '440206000', '766982000', '5315003', '191177007', '1269225005', '782909004', '111588002', '439699000', '724356003', '1162804003', '773489008', '782911008', '45366001', '75443009', '8857001', '66262001', '73073009', '5994005', '15121005', '234410008', '31925001', '33297000', '41788008', '438372000', '438792009', '88776002', '40855001', '28293008', '234442002', '438360006', '37350004', '49762007', '43217004', '439460003', '439455002', '439459008', '50189006', '95841006', '783255002', '54006005', '61395005', '16964007', '783254003', '439274008', '439702007', '55995005', '69981004', '47516005', '33905008', '25266006', '1172699002', '783251006', '783250007', '438827002', '1259242002', '128106003', '359700009', '128113003', '128114009', '128107007', '359711001', '359717002', '359725000', '359732009', '128108002', '441101007', '440988005', '27312002', '3947004', '62268000', '52413004', '52212006', '42484009', '34194007', '74703006', '234383000', '26682008', '119641000119103', '1153399000', '441188004', '441189007', '39586009', '85557000', '89459006', '56205004', '32855007', '724344004', '711161006', '234458004', '191256002', '6398009', '423294001', '62871001', '722005000', '1659471000000105', '1659461000000103', '86635005', '234380002', '1217208003', '1156784009', '1172685001', '771075004', '718554005', '237617006', '1285665003', '440868005', '1285666002', '441192006', '26029002', '1285655009', '425949001', '1285656005', '440820004', '24975009', '32648007', '128100009', '1285663005', '440867000', '1285664004', '441191004', '33344008', '1285659003', '438599002', '1285660008', '441006000', '1156805003', '733028000', '109998009', '712922002', '402851000', '722125003', '774071007', '127057004', '127058009', '763864008', '9417000', '128101008', '80126007', '1251448003', '109992005', '16740451000119109', '35703006', '1153349004', '1264010001', '191211009', '128115005', '723512008', '37272000', '409617000', '128098009', '1237617004', '50253007', '127052005', '191213007', '234363001', '1187614006', '725463007', '1285661007', '440866009', '1285662000', '441190003', '16872008', '1285657001', '438373005', '1285658006', '440993008', '10564005', '77413008', '89454001', '10759351000119103', '127045008', '234391009', '127043001', '127042006', '127041004', '127044007', '35434009', '417517009', '417683006', '25472008', '417748003', '416214006', '47024008', '416484003', '416638004', '127040003', '127046009', '723674005', '723623002', '57020009', '61777009', '711407000', '1197595004', '78129009', '237934001', '721307000', '724643004', '234375006', '18273004', '373420004', '707151000', '41106001', '3978000', '718553004', '21412009', '25443007', '48983004', '722475006', '782759001', '719816006' )
ORDER BY concept_name

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.bbe9f7ee-7907-42c0-9bc2-aabdd9bb8325"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_hematologic_disease=Input(rid="ri.foundry.main.dataset.39c95734-2077-45fa-b24b-4d5c67aee030")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_hematologic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.205db57f-8da7-408a-a44d-ad0de4300e71"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_hematologic_disease_data=Input(rid="ri.foundry.main.dataset.bbe9f7ee-7907-42c0-9bc2-aabdd9bb8325")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data 
    where condition_source_value in ('D56.1', 'D56.0', 'O14.2', 'D58.0', 'D56.2', 'D47.3', 'D68.1', 'D61.0', 'D45', 'D56.4', 'D67', 'D60.1', 'D66')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_hematologic_disease_data
) as rare_hematologic_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.e7cccdcc-2de7-4a51-aab9-3b018fdb585a"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_hepatic_disease" rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('238033007', '716379000', '18917003', '13265006', '45042004', '722864002', '413438002', '1187643003', '720461006', '774207004', '66576001', '700463002', '1197704005', '408335007', '721711009', '721712002', '721713007', '838305005', '1186854003', '31155007', '717047007', '717187000', '717232005', '1237346001', '371090009', '235888006', '10750161000119106', '724766009', '16098491000119109', '735733008', '719454003', '1260140008', '398197009', '1204346009', '72925005', '28259009', '8933000', '68067009', '238035000', '44553005', '1208726006', '771149000', '724361001', '1230342001', '718096004', '771441005', '715864007', '1234822009', '722870008', '717329009', '1220580006', '716196007', '721847002', '715577009', '47444008', '19682006', '715397000', '4283007', '6160004', '713698004', '699189004', '773737004', '24805007', '1230291009', '1234821002', '197441003', '1155913007', '1155841005', '1186865008', '74162007', '723829000', '1197150002', '715401008', '32891000', '197442005', '447058001', '773649005', '65617004', '190823004', '88518009')
ORDER BY concept_name

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.bc6082d4-024b-461a-a199-df3eb5e4105b"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_hepatic_disease=Input(rid="ri.foundry.main.dataset.e7cccdcc-2de7-4a51-aab9-3b018fdb585a")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_hepatic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.26c4ace1-5c3f-413b-93ed-f87ef0413c97"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_hepatic_disease_data=Input(rid="ri.foundry.main.dataset.bc6082d4-024b-461a-a199-df3eb5e4105b")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data 
    where condition_source_value in ('E80.5', 'K75.4', 'K74.3', 'Q44.6')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_hepatic_disease_data
) as rare_hepatic_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.a820c25c-bf65-4350-8597-deccdedbc25c"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_immune_disease" rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('782915004', '711480000', '402355000', '121121000119106', '1144963000', '987840791000119102', '44940001', '784392009', '784393004', '1260096003', '14333004', '234558001', '720497002', '234560004', '234561000', '234559009', '720520009', '722288007', '702444009', '1197361002', '722290008', '778004006', '829973009', '707273001', '725150008', '725151007', '770947009', '707272006', '771309000', '1172892009', '725431001', '725432008', '1279842008', '1197366007', '783201001', '783200000', '783058007', '783199003', '1229941002', '1229940001', '1179300002', '762618008', '1177120001', '234633000', '111396008', '403001004', '359757004', '240719002', '402356004', '128631000119109', '387759001', '29272001', '40197009', '77330006', '26252007', '82317007', '21527007', '76243000', '240718005', '234593008', '234613004', '1186712009', '725135004', '1186715006', '717811007', '1197205005', '1179286007', '784340000', '1186714005', '1197477000', '773488000', '1179285006', '766879006', '725290000', '771479000', '1179288008', '716378008', '783743009', '23238000', '191010004', '191013002', '191011000', '191012007', '234595001', '234594002', '234596000', '234597009', '234598004', '234599007', '234609006', '263661007', '234611002', '234612009', '234616007', '234614005', '234615006', '234617003', '771443008', '1162263002', '775909002', '765327005', '444547006', '191347008', '350353007', '721093000', '1197479002', '74911008', '723334006', '235073000', '240714007', '240717000', '240716009', '398250003', '234646005', '1268379007', '846606007', '190959006', '724361001', '129639005', '9311003', '707276009', '403834003', '50926003', '783249007', '783248004', '763713000', '725136003', '778028008', '766705006', '771078002', '783621008', '9893005', '234539005', '699869003', '764858009', '770942003', '1144907001', '1144908006', '1187233008', '234582006', '234583001', '1269277004', '402357008', '763668009', '724177005', '402360001', '716869006', '718230004', '721876004', '721877008', '723384004', '723385003', '723386002', '783734000', '778024005', '129644003', '725137007', '723443003', '55602000', '1230308005', '275446004', '783142006', '717231003', '11244009', '1186719000', '1269234000', '778027003', '718717004', '1197478005', '724275005', '783245001', '81166004', '60743005', '718232007', '723508002', '1144933009', '1144934003', '783007005', '111584000', '351287008', '723512008', '783099001', '71904008', '402358003', '190979003', '234541006', '234540007', '190981001', '234542004', '190980000', '771517009', '765188009', '1229942009', '763623001', '715982006', '716871006', '782751003', '1179284005', '783617001', '720853005', '722067005', '720345008', '789777007', '1197362009', '1197415001', '1197482007', '766983005', '778045003', '770785002', '765145001', '718107000', '782750002', '234608003', '234571003', '403837005', '65880007', '708536001', '403835002', '724276006', '711481001', '1162828001', '1162830004', '719814009', '718882006')
ORDER BY concept_name

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.376de7fe-c48f-4fe9-ac65-3095aaee4c4d"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_immune_disease=Input(rid="ri.foundry.main.dataset.a820c25c-bf65-4350-8597-deccdedbc25c")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_immune_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.8614e4b4-d3b9-413c-8786-16a61fc0bfc5"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_immune_disease_data=Input(rid="ri.foundry.main.dataset.376de7fe-c48f-4fe9-ac65-3095aaee4c4d")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data 
    where condition_source_value in ('D81.5', 'D82.2', 'D76.2', 'D81.7', 'D80.0', 'D80.4', 'D81.3', 'D81.0', 'D81.6', 'B22.2', 'D81.4')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_immune_disease_data
) as rare_immune_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.edac13f1-4717-42e4-9bda-3d13daf802d3"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_inborn_errors_of_metabolism " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('782918002', '791000124107', '719652007', '725286002', '237957007', '307130006', '237951008', '297231002', '297232009', '297233004', '711412004', '764860006', '711409002', '41797007', '237914002', '267454002', '57863006', '1155910005', '234422006', '12246008', '725046003', '238069004', '69614003', '366951000119109', '65389002', '1269423000', '852781000000103', '399249008', '238027003', '725464001', '733599009', '711155008', '720941007', '720976009', '720977000', '720978005', '1187542000', '238048001', '879937000', '880065001', '880066000', '23501004', '702440000', '41013004', '1156792000', '778025006', '1222649004', '771448004', '717045004', '717046003', '827115000', '1156857003', '1156858008', '1156855006', '1156856007', '1156853004', '1269235004', '783768006', '783767001', '827117008', '238024005', '25010000', '1187541007', '238047006', '784373007', '238068007', '8808004', '717942003', '718210003', '192787004', '238023004', '238021002', '238022009', '1237417007', '765329008', '718712005', '725044000', '724142005', '725587007', '732252005', '733450008', '297253000', '238003000', '238001003', '238002005', '1187174002', '367041000119108', '773668008', '773492007', '63246000', '57218003', '62201009', '1149103000', '716863007', '54064006', '7573000', '890435004', '890436003', '73843004', '82245003', '718750004', '1197753005', '718751000', '721100009', '1220574003', '717773005', '717774004', '713401006', '35691006', '307128009', '702365002', '783558004', '763110007', '778065005', '763203009', '775908005', '764943000', '763211004', '1173036000', '1222680009', '1173035001', '1173034002', '1172844009', '1172843003', '1172841001', '766876004', '724279004', '763204003', '733600007', '763209008', '783178001', '763212006', '237945003', '773648002', '717812000', '709412006', '725078006', '724096007', '897592003', '725079003', '733084000', '733085004', '733601006', '733083006', '733451007', '459063003', '22935002', '236466005', '718219002', '782772000', '59252009', '59399004', '24308003', '190681003', '237955004', '237960000', '419097006', '763688008', '444838008', '124258007', '733630004', '124466001', '124525004', '124600004', '124511000', '360619001', '360943000', '719449007', '124116001', '124621004', '124302001', '1187616008', '124239003', '124473006', '445274004', '717185008', '124115002', '124141008', '124680001', '124327008', '360994007', '124177001', '124309005', '124252008', '124354006', '782828005', '237980004', '237619009', '236475007', '716747007', '29914000', '58256000', '238014002', '237913008', '237923004', '52186006', '27642008', '51984006', '111383007', '81896006', '1172627007', '1187534001', '715980003', '763280005', '726702005', '297238008', '61164006', '51022005', '860859009', '1186810009', '40278002', '190764000', '715830008', '16652001', '763531001', '723360007', '721838005', '59229005', '75652008', '1187040004', '79935000', '718124006', '715338007', '720951008', '1237619001', '28183005', '1230310007', '64716005', '237983002', '238030005', '8849004', '192782005', '237941007', '78586005', '1156813002', '190794006', '297237003', '716721003', '1222658006', '41142009', '30102006', '59761008', '22886006', '360416003', '238070003', '297256008', '61598006', '235908005', '297252005', '274864009', '722302009', '722343009', '1187461004', '1162916008', '819953000', '1187462006', '7265005', '444707001', '66937008', '11179002', '860860004', '55912009', '29291001', '89597008', '717821004', '238025006', '722762005', '703388005', '774205007', '23447005', '36891003', '22011005', '1230003009', '719974003', '297254006', '297255007', '725026008', '764962002', '7425008', '20052008', '726079008', '16242007', '69525003', '90093009', '428530009', '78311009', '360369003', '721225009', '360378009', '238054000', '238053006', '238056003', '111386004', '428014009', '238057007', '5667009', '73146005', '1237349008', '410059004', '57119000', '764456001', '2359002', '403834003', '718106009', '717182006', '721234004', '717048002', '721236002', '721834007', '702377007', '763720007', '30287008', '717181004', '771509001', '718713000', '776416004', '771339005', '721173005', '70199000', '84121007', '61172008', '238026007', '62332007', '238062008', '80887004', '405287008', '405288003', '780820008', '1264009006', '307127004', '87827003', '722457005', '399045007', '18756002', '50855007', '22830006', '25792000', '1216941002', '237961001', '237982007', '1264112006', '719257008', '1172839002', '782744007', '782745008', '1269231008', '303852004', '50056009', '71751002', '715923003', '361203007', '1231141008', '62311004', '725028009', '27718001', '71702000', '69463008', '26015003', '67854007', '58263000', '717052002', '717054001', '773549000', '128596003', '59178007', '724146008', '721187005', '13144005', '765137006', '771444002', '1172683008', '23156007', '237954000', '237953006', '1231309005', '1197052008', '1208937004', '782771007', '771478008', '732951005', '784370005', '724138007', '718214007', '1217212009', '1196948002', '1196873001', '1196870003', '1196872006', '237999008', '378007', '725296006', '75610003', '65327002', '26745009', '70737009', '41572006', '59990008', '75238000', '15892005', '73123008', '7259005', '238044004', '43916004', '1208485009', '1208486005', '1208621008', '1279890001', '1279891002', '54898003', '725027004', '55783001', '61772003', '699328003', '1187514002', '699268002', '1251446004', '1251447008', '784346006', '238061001', '1187511005', '25765006', '717155003', '80902009', '237988006', '52165006', '39390005', '66751000', '86444004', '72488000', '67855008', '1222655009', '80908008', '69478001', '722207000', '78960005', '237946002', '237985009', '870313002', '341536001', '342553006', '66002008', '440009', '40751003', '783717008', '190687004', '1003938005', '5335002', '1187623009', '723454008', '67817003', '774148007', '1228849007', '64081000', '61860000', '764733009', '20415001', '61071003', '399087009', '399149003', '303094000', '303095004', '65764006', '276261007', '732245008', '87694001', '1003850000', '1003851001', '1003849000', '1003847003', '1197430005', '21764004', '717053007', '765100000', '87074006', '23849003', '88393000', '64852002', '1187250005', '45116002', '1284855000', '1187536004', '773423007', '1237339005', '787412002', '1237512003', '34566007', '278991002', '723675006', '238051008', '238104009', '65419005', '723624008', '1187171005', '771516000', '402479002', '5963005', '237989003', '49748000', '238004006', '40873003', '1237181009', '1260133007', '111385000', '71253000', '68724006', '31368008', '703527003', '1208738002', '718212006', '238020001', '238018004', '238019007', '237933007', '11225002', '75387001', '723552005', '234405009', '59531002', '1186849007', '1186844002', '4887000', '410056006', '415764005', '58275005', '237997005', '1260128008', '82500001', '698290008', '1197360001', '732246009', '88469006' )
ORDER BY concept_name

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.0a3377de-6d4f-45ab-918b-32516a75be78"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_inborn_errors_of_metabolism=Input(rid="ri.foundry.main.dataset.edac13f1-4717-42e4-9bda-3d13daf802d3")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_inborn_errors_of_metabolism A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.85bfffa4-b16d-4684-b5a0-5a17b1d2d044"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_inborn_errors_of_metabolism_data=Input(rid="ri.foundry.main.dataset.0a3377de-6d4f-45ab-918b-32516a75be78")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data 
    where condition_source_value in ('E76.1', 'E76.0', 'E71.0', 'E80.3', 'H49.4', 'P74.5', 'E70.0', 'E80.1')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_inborn_errors_of_metabolism_data
) as rare_inborn_errors_of_metabolism_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.1d2a62fd-759b-4be2-bfb5-90e7926f5866"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_infectious_disease" rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ( '43894001', '240459003', '721807009', '14770001000004107', '1163473005', '231896005', '4340003', '402993003', '402994009', '402986002', '402985003', '402129006', '402987006', '402995005', '237448006', '186394003', '237048004', '230209006', '237085007', '1163145003', '1193731009', '1193729000', '11817007', '186397005', '192649000', '187089001', '195908008', '197964007', '186116005', '111912001', '186311005', '266237004', '838358000', '1268520007', '194926000', '111286002', '446957000', '446311006', '240653009', '186813004', '722889008', '240800002', '3071000119108', '240730004', '838356001', '186626002', '235864009', '459056003', '1163134001', '1163089000', '240390000', '426637005', '240828008', '240826007', '30595008', '763310000', '240463005', '14535005', '429297003', '403126006', '186476008', '240460008', '64764001', '446958005', '447262002', '447378002', '186478009', '186479001', '186480003', '184431000119108', '398102009', '446312004', '240741002', '187027001', '58524006', '409553007', '1163086007', '1264007008', '1156793005', '78511005', '406558002', '27031003', '240631007', '72294005', '18342001', '186287003', '26826005', '50227004', '75119003', '65095005', '402141004', '403135004', '1193807005', '1193806001', '240854000', '63479002', '22728002', '38725001', '7386008', '32266007', '10093004', '398327006', '195902009', '58868000', '838360003', '186807008', '10446001', '713732008', '1193650002', '1193649002', '445058002', '1163146002', '413583003', '1177039008', '1163130005', '1163536005', '302905001', '403128007', '723147008', '21061004', '57725006', '91586009', '240823004', '234108004', '240822009', '48982009', '15693201000119102', '56625005', '838301001', '838302008', '67247008', '240403008', '400008009', '240402003', '186774005', '240524001', '47761007', '1177065007', '406564009', '1177066008', '202698007', '1177063000', '75702008', '402127008', '413716003', '50797007', '85658001', '838295002', '240648004', '240843005', '18116006', '63553008', '186957004', '60916008', '79974007', '764811001', '240431004', '54043007', '39524009', '88558006', '1163131009', '1163151008', '187094001', '230215006', '230214005', '240845003', '53622003', '23014006', '186815006', '998008', '186816007', '31877008', '240656001', '240659008', '240654003', '716584007', '111864006', '81020007', '240349003', '240350003', '240351004', '417405005', '733170007', '22462001', '1163150009', '240658000', '722890004', '240801003', '28791000119105', '240732007', '773738009', '1163147006', '838380002', '240374000', '234093002', '240829000', '240824005', '194207002', '403127002', '417688002', '240742009', '733171006', '233615002', '26427008', '409552002', '240392008', '1163148001', '235869004', '735451005', '840453009', '240736005', '240739003', '240738006', '240733002', '240735009', '240734008', '240737001', '240641005', '735531008', '11938002', '37688005', '65696007', '406567002', '1163139006', '1163138003', '422337001', '41030002', '78223000', '240729009', '24360007', '6452009', '1141602008', '276664005', '716660007', '276671000', '721274005', '716865000', '762725007', '7964000', '240669002', '51634001', '1290821000000106', '70090004', '88129004', '417441005', '43489008', '416877003', '417344003', '416296007', '35974005', '417547006', '42386007', '421403008', '715849007', '406569004', '421278000', '6365004', '278039004', '111899005', '240786004', '718373005', '240727006', '240724004', '240813008', '240744005', '240449004', '19362000', '16429005', '73532000', '442081006', '240637006', '402128003', '240778004', '64650008', '419817006', '43484003', '187115002', '80890005', '240855004', '716860005', '721822004', '1163537001', '240114004', '441460004', '187148002', '187149005', '403132001', '5093001', '53991003', '54026009', '83159006', '1163497001', '416597004', '266152000', '733193001', '403152000', '371062005', '240894003', '20927009', '409676000', '409677009', '409678004', '409679007', '409671005', '402160006', '59671002', '8410006', '38573008', '442003006', '240645001', '240404002', '187151009', '93424000', '105671004', '105675008', '105668007', '105663003', '105664009', '105662008', '105667002', '105674007', '105657007', '105673001', '105672006', '414015000', '105666006', '105669004', '105676009', '105661001', '105665005', '721817004', '24779007', '402992008', '240743004', '4499004', '7671008', '240787008', '85055004', '240785000', '403110005', '240746007', '403124009', '240759004', '428217009', '425418002', '200426004', '713445006', '240446006', '735520000', '28697001', '240781009', '240443003', '402990000', '419532006', '240632000', '91051003', '187176005', '240409007', '41235001', '840503000', '733148009', '240821002', '416925005', '417496004', '417573001', '240616003', '37109004', '74942003', '26103000', '403131008', '75006000', '187137009', '20790006', '75388006', '1086721000119102', '65963007', '21009004', '27235001', '1086731000119104', '1176986000', '47087004', '45115003', '1176983008', '271501007', '36607007', '238368001', '406572006', '14100003', '700263000', '700337008', '721826001', '721823009', '16901001', '186591007', '721790006', '840440006', '721791005', '860822008', '721818009', '721819001', '721821006', '721820007', '721825002', '712986001', '721815007', '860865009', '860866005', '1082451000119102', '428638009', '427796004', '441512004', '186499007', '860842004', '128191000', '1290801000000102', '194931003', '720989003', '460618008', '194929007', '1231258007', '1193803009', '1193802004', '240782002', '733173009', '418480000', '398256009', '69588003', '410038006', '410040001', '240760009', '240445005', '1163526002', '240809001', '414171001', '5631000124102', '62676009', '17110002', '240804006', '1163523005', '403129004', '403111009', '86497005', '398523009', '409564005', '409565006', '409566007', '409567003', '721657003', '26275000', '266169003', '240111007', '1231142001', '64250002', '266092000', '860887000', '111923002', '240384004', '187101004', '240811005', '240434007', '56978007', '135261000119106', '1172791005', '702577006', '21857006', '15996831000119101', '1163491000', '1163484003', '61048000', '860834000', '860864008', '860840007', '860886009', '240847006', '120639003', '240803000', '240493004', '408681003', '408682005', '408683000', '24620004', '77663007', '1163482004', '716864001', '240636002', '409641002', '773582002', '186395002', '187093007', '240791003', '90753004', '197342009', '240789006', '860856002', '1163464002', '230177004', '1144966008', '1144968009', '21954000', '230176008', '76474001', '9678009', '240412005', '187041005', '187040006', '187039009', '1163481006', '187051006', '187050007', '187049007', '406587001', '187062006', '430399004', '677201000119104', '677211000119101', '677221000119108', '420945005', '187059008', '187058000', '1163065007', '240626005', '359747000', '1163063000', '735522008', '735524009', '735526006', '735528007', '398446008', '714279000', '721264007', '237458005', '187144000', '234503004', '240115003', '44917000', '36334003', '77412003', '1156829005', '266090008', '399183005', '409637001', '240461007', '14386001', '240639009', '240643008', '3095005', '609493004', '414488002', '397928009', '6298007', '16880001', '83591004', '29007000', '61750000', '35033008', '442652006', '60960008', '56691005', '29871001', '24147008', '63764008', '53893001', '4860004', '46892008', '28671007', '77456003', '83937008', '51613008', '73908004', '4921002', '12329007', '76999009', '38333003', '33583009', '77214000', '442543009', '12524001', '3641001', '28500000', '56913005', '240783007', '66328003', '79064007', '46979009', '78081007', '47936004', '28952007', '2114004', '11051005', '37584004', '74671004', '7877005', '34240005', '6150008', '73328005', '80410000', '396334002', '52918004', '68383000', '38302000', '441554001', '12825006', '8490007', '38243003', '111922007', '69550000', '42113004', '54266002', '253090002', '43017006', '5082003', '55065004', '59760009', '13549009', '81086003', '22905009', '76255006', '62078006', '88264003', '269574000', '59121004', '39625001', '81551009', '77327004', '5765005', '44250009', '420811004', '37832003', '26123004', '699676006', '111907002', '31819001', '416574002', '416372004', '16142004', '29009002', '4835004', '27776006', '64968009', '38539003', '33856003', '90990009', '90281006', '36779002', '52746006', '15693002', '84110003', '30369007', '75256000', '33421006', '7493006', '27794000', '39660007', '75418003', '75549005', '28850000', '6464001', '39740009', '43925005', '3529000', '27335004', '10087007', '111920004', '8841001', '62108008', '2850009', '58650000', '52179003', '38201005', '82697002', '6752005', '42197002', '15900006', '21437004', '80277008', '1214006', '63121009', '19549003', '72783005', '82919002', '18956009', '71844000', '84910004', '17425008', '55629005', '3254001', '49078004', '41645005', '8178001', '63570000', '57992009', '74587007', '442259005', '77506005', '75809006', '42872003', '62921000', '77947001', '65528008', '866078000', '372972007', '877043181000119101', '398565003', '715075005', '721764008', '713545009', '23257009', '713490002', '470661000124100', '713339002', '723865005', '723864009', '372973002', '372974008', '372975009', '372976005', '372977001', '372978006', '372979003', '372980000', '372981001', '372983003', '372984009', '372985005', '372986006', '372988007', '372989004', '372990008', '372991007', '372992000', '372993005', '372994004', '372995003', '372996002', '372997006', '372998001', '373000005', '373001009', '373002002', '373003007', '373004001', '373005000', '373006004', '373007008', '373008003', '427795000', '428174001', '427999003', '428592003', '429600003', '63194008', '388759003', '68013003', '22312005', '70543009', '65267003', '406597005', '406619001', '406575008', '735533006', '715507005', '735534000', '840432000', '866085001', '1163500007', '866120006', '721808004', '866122003', '860861000', '735532001', '721804002', '866140004', '733166004', '1163462003', '1141645001', '1162918009', '461416009', '459174005', '460490009', '460358000', '459172009', '459068007', '459067002', '1141647009', '459178008', '459059005', '459058002', '459158000', '459061001', '459152004', '459153009', '459159008', '459060000', '459151006', '459154003', '461429009', '819949002', '414495006', '17251008', '22464000', '54284000', '22203006', '8383003', '59989004', '726020009', '866134006', '772828001', '11389007', '409562009', '187187002', '409563004', '359799003', '240802005', '240375004', '240796008', '187174008', '1102005', '430404002', '733168003', '733169006', '1163476002', '1163474004', '1163475003', '707211005', '763772002', '1163472000', '240867002', '371423007', '713546005', '52947006', '42100005', '262781009', '15693241000119100', '15693281000119105', '230170002', '1163553003', '23097003', '422770008', '61094002', '404240007', '240819007', '19065005', '50414000', '423718003', '240448007', '26726000', '195889001', '403136003', '240635003', '403137007', '240638001', '1231140009', '77746001', '16442005', '414600000', '21560005', '81004002', '1179403004', '128215004', '1176984002', '240405001', '284184004', '406589003', '186956008', '240673004', '77377001', '80194003', '79309005', '402959002', '703537008', '240393003', '29786001', '406590007', '186317009', '186318004', '31568009', '24630008', '57420002', '4241002', '240798009', '240844004', '866116007', '735738004', '866117003', '240429008', '14683004', '39111003', '228007', '716585008', '240650007', '33937009', '1142227009', '77863005', '410475008', '232314004', '240671002', '410474007', '230605007', '1269516003', '410473001', '240820001', '419323005', '87603003', '38700005', '26067004', '111796005', '722888000', '186795000', '10809061000119106', '83072009', '206445003', '240629003', '240827003', '44051003', '240440000', '240849009', '866091004', '77503002', '240858002', '199183007', '197143009', '196599007', '32094009', '428111003', '713624009', '713625005', '713626006', '721765009', '721792003', '721753005', '721824003', '721814006', '1084801000119107', '230150008', '34845009', '192644005', '397565001', '397566000', '421020000', '713881001', '400154003', '240642003', '240868007', '428508008', '16038004', '21070001', '51423006', '60021008', '359814004', '17273001', '721813000', '36866003', '1163538006', '76627001', '1163496005', '240780005', '416257001', '25668000', '403112002', '403113007', '403114001', '403115000', '403116004', '403117008', '403118003', '403119006', '403120000', '403121001', '403122008', '95881004', '764993001', '86348002', '45194000', '82710007', '82686002', '866045007', '866064001', '866061009', '866062002', '866124002', '866127009', '866121005', '866123008', '866067008', '866065000', '871587002', '460338001', '93465000', '420706008', '240779007', '763888005', '443928008', '414820001', '359646002', '721279000', '402967005', '197606008', '240401005', '417607009', '422498005', '1177012000', '230194002', '195909000', '29227009', '421431004', '870353004', '240667000', '423592001', '277869007', '186378005', '788997004', '417254001', '416770009', '240842000', '240866006', '186319007', '73363000', '240618002', '48113006', '231992006', '240839006', '234101005', '240840008', '240838003', '240836004', '403093005', '403096002', '1059007', '1177030007', '420121005', '397562003', '398575000', '240453002', '1163078007', '283688006', '76490001', '19341001', '30865009', '240649007', '187145004', '59925007', '240812003', '240810006', '415035006', '240436009', '870326003', '870296007', '870298008', '870302000', '76623002', '71085009', '51254007', '402964003', '85904008', '416483009', '723088005', '240806008', '197300007', '76090006', '58750007', '186284005', '186791009', '4911000124103', '186796004', '186792002', '1177035002', '51169003', '443201006', '1177059007', '88860002', '415125002', '420403001', '1149093006', '442094008', '38699009', '707508008', '707507003', '707503004', '111900000', '32286006', '45312009', '38976008', '240814002', '240817009', '240447002', '67896006', '240438005', '79949009', '240745006', '402989009', '240758007', '23247008', '35339003', '88036000', '445880000', '302811004', '22255007', '713487008', '420554003', '10082001', '56140006', '1090331000119100', '233853009', '764104003', '187239003', '21846001', '187052004', '20953001', '50997000', '240391001', '233614003', '2087000', '1177000004', '73995006', '9228003', '45263007', '45556008', '2439002', '30330001', '409555000', '409556004', '95890006', '409554001', '233867000', '409557008', '233884006', '27618009', '240464004', '266196000', '240462000', '240465003', '1685005', '17794004', '187100003', '240784001', '20443005', '233851006', '75096007', '402917003', '1163071001', '425177009', '426087004', '186772009', '192689006', '13225007', '840499006', '240644002', '88905005', '30242009', '1217227009', '1177043007', '1177078007', '60979006', '268058007', '1177055001', '240790002', '236689006', '111005008', '240793000', '236686004', '750009', '236685000', '236599009', '271425001', '67525007', '240389009', '9012003', '201517005', '82308007', '36188001', '415525005', '15316002', '240439002', '240670001', '67924001', '74724001', '415561000', '240841007', '1237418002', '19044004', '240794006', '1177068009', '42094007', '29081001', '5168000', '111003001', '73028002', '200946001', '240450004', '417192005', '416129000', '52138004', '238448008', '186357007', '240451000', '240857007', '240856003', '1177070000', '1163542009', '421883002', '186312003', '73774007', '240731000', '1163075005', '838316003', '782761005', '240728001', '240851008', '240657005', '86333008', '238442009', '240437000', '240792005', '67391006', '278480000', '186875004', '186878002', '186877007', '94851000119107', '240701006', '77798004', '187091009', '10651001', '240433001', '1264130004', '1264131000', '43424001', '61145000', '240432006', '69668008', '234100006', '424327005', '187084006', '406620007', '18504008', '127421000119109', '127411000119102', '231994007', '415737009', '417097002', '312106007', '1163540001', '240118001', '707509000', '1177184008', '26089000', '82214002', '240117006', '111921000', '65110003', '788980005', '788981009', '1163549000', '70143003', '52987001', '19265001', '64612002', '240407009', '240410002', '398554008', '1179407003', '402963009', '4834000', '75656006', '715067004', '37722001', '240408004', '74166005', '236706006', '410476009', '402884000', '111852003', '397552005', '47452006', '359673001', '240441001', '459057007', '707341005', '240105009', '186803007', '187072009', '27052006', '398067003', '47523006', '240615004', '392662004', '39439008', '41545003', '398530003', '240880004', '3928002', '16468121000119106', '15207003', '59277005')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.11cfd965-73c0-4605-ba75-b0bf161898cf"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_infectious_disease=Input(rid="ri.foundry.main.dataset.1d2a62fd-759b-4be2-bfb5-90e7926f5866")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_infectious_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.ff22e10d-b481-4051-b572-bf744abc65a8"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_infectious_disease_data=Input(rid="ri.foundry.main.dataset.11cfd965-73c0-4605-ba75-b0bf161898cf")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('B75', 'A48.1', 'A05.1', 'B00.4', 'G05.1', 'B73', 'B83.0', 'A81.2', 'A69.0', 'A98.5', 'N08.0', 'B81.0', 'A07.0', 'A98.2', 'A98.1', 'B33.4', 'J17.1', 'A92.4', 'A96.1', 'A98.4', 'A96.0', 'B74.4', 'B74.3', 'B72', 'G04.1', 'A92.5', 'B17.0', 'B70.0', 'B60.0', 'B48.5', 'A07.3', 'B71.0', 'B88.1', 'A79.0', 'A44.0', 'G00.1', 'A48.3', 'L00', 'G01', 'A39.0', 'A28.1', 'A69.2', 'A75.3', 'A75.2', 'A75.0', 'A77.0', 'A79.1', 'A48.2', 'A01.0', 'A75.1', 'A25.1', 'A25.0', 'A98.0', 'A96.2', 'A98.3')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_infectious_disease_data
) as rare_infectious_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.d81e828f-0214-4df7-954e-461701fb2862"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_infertility_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('236805000', '1172637002', '770726004', '236806004', '764096006', '717158001')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.dbe98c3f-0ded-4431-be76-a41aa0cfa735"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_infertility_disease=Input(rid="ri.foundry.main.dataset.d81e828f-0214-4df7-954e-461701fb2862")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_infertility_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.2aca5d94-3a7e-4988-bf87-9ab36d5e705c"),
    rare_infertility_disease_data=Input(rid="ri.foundry.main.dataset.dbe98c3f-0ded-4431-be76-a41aa0cfa735")
)
-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM rare_infertility_disease_data

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.0a4bcaf7-4178-4c0e-88a7-65d6a5c44735"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_maxillo_facial_surgical_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ( '827174006', '1186726000', '733091002', '722389002', '763215008', '81139004', '32883009')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.3d6f0d8f-738e-4a2b-a398-3eeb554118bc"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_maxillo_facial_surgical_disease=Input(rid="ri.foundry.main.dataset.0a4bcaf7-4178-4c0e-88a7-65d6a5c44735")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_maxillo_facial_surgical_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.943bdbf2-bd07-431f-bf10-96f3db509d94"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_maxillo_facial_surgical_disease_data=Input(rid="ri.foundry.main.dataset.3d6f0d8f-738e-4a2b-a398-3eeb554118bc")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('K13.5')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_maxillo_facial_surgical_disease_data
) as rare_maxillo_facial_surgical_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.c014ecff-0613-48b2-8a3b-eb75cd026ab0"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_neoplastic_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('1234830005', '400153009', '413389003', '2961000119106', '16594881000119101', '16594841000119106', '764856008', '277602003', '766045006', '766048008', '766046007', '359631009', '61311000119104', '1157157006', '1237368006', '838355002', '764855007', '780844005', '359648001', '426124006', '445448008', '763309005', '359640008', '61321000119106', '733598001', '725390002', '1148906001', '444911000', '110005000', '427658007', '110004001', '425869007', '285769009', '1264458000', '764845008', '408644002', '276803003', '765741003', '304545002', '787091002', '449153001', '838349007', '764846009', '763064007', '423615009', '422833009', '423189008', '1260024007', '385478001', '254888007', '404067008', '715403006', '1197204009', '110007008', '898197001', '240531002', '1162584006', '721600008', '238864005', '721310007', '404136008', '716655008', '715950008', '109982002', '123313007', '25050002', '285311001', '447729009', '1156409003', '448212009', '703626001', '738770003', '404023006', '1196902006', '1156412000', '404135007', '413537009', '1090241000000107', '404013002', '447757002', '109844006', '254794007', '16091171000119106', '187821001', '440422002', '307341004', '782774004', '16903531000119107', '1156470000', '765057007', '717731002', '1255647008', '1254801006', '307592006', '277474005', '277619001', '788874003', '351171000119101', '123181000119106', '123141000119101', '123121000119107', '123151000119104', '123241000119109', '87161000119107', '838304009', '426134002', '1196886005', '1196833007', '1196835000', '1230023005', '417647002', '18831000119107', '92100009', '189120005', '15933101000119101', '15933061000119104', '130521000119106', '130471000119108', '130221000119108', '130191000119102', '720344007', '1081411000119109', '1081421000119102', '1172840000', '721570000', '447799001', '784307009', '15957261000119102', '15977711000119107', '15952821000119105', '1263460007', '254819008', '413656006', '445105005', '1081431000119104', '1081441000119108', '404052009', '399911003', '783541009', '713897006', '1255796007', '1255895001', '118617000', '188512009', '188515006', '188511002', '188517003', '188516007', '1255749004', '1255751000', '1255750004', '35868009', '734884008', '253002004', '254627002', '276808007', '276876007', '254462001', '716593008', '254466003', '254465004', '722377004', '733492003', '404126000', '404127009', '404026003', '716592003', '716661006', '447792005', '1153424004', '1153425003', '1153422000', '1153423005', '1153426002', '1153421007', '1153427006', '715900001', '188733003', '722955006', '122881000119107', '413842007', '413843002', '92817004', '188734009', '413847001', '762690000', '765328000', '734015000', '274902006', '277573001', '237249000', '403984006', '1156403002', '360525006', '254748009', '404047004', '254761009', '254762002', '1208475008', '404072004', '1156495004', '276799004', '448296006', '447710003', '404010004', '404009009', '404008001', '254747004', '780822000', '389216001', '816979008', '773537001', '724647003', '734066005', '770628008', '254242006', '713718006', '449177007', '449221001', '1196837008', '722956007', '700057001', '1156454002', '254872007', '403979000', '123842006', '254876005', '277654008', '254939008', '107561000119107', '147121000119104', '101571000119107', '254949006', '404045007', '404032008', '609515005', '716788007', '93451002', '426642002', '683991000119103', '400129003', '782672006', '768937006', '188718006', '353211000119103', '445269007', '414166008', '716649003', '404079008', '860832001', '716787002', '254843006', '1197359006', '1264340007', '403972009', '726019003', '715414009', '1222705009', '786038001', '716657000', '715412008', '253018005', '10871331000119105', '254865006', '10871371000119108', '448139005', '187822008', '765190005', '847481000000109', '847631000000107', '847651000000100', '1148851002', '1148845007', '404109006', '308121000', '702977001', '702786004', '1148847004', '109972003', '109971005', '448666006', '448995000', '448561007', '449419008', '448672006', '354851000119101', '449219006', '448231003', '449063007', '449307001', '448217003', '448865007', '448317000', '449222008', '449418000', '449058008', '449059000', '109970006', '109984001', '782680004', '1156816005', '424631008', '254766004', '771474005', '1153388002', '1153386003', '1153387007', '709287005', '1153384000', '1153385004', '860829004', '860828007', '860830009', '1153404003', '1153405002', '1196912004', '446124001', '446925001', '445737002', '445736006', '417570003', '404016005', '709210000', '709204000', '709214009', '709211001', '710211000', '710205003', '710209009', '712527004', '712526008', '254846003', '404027007', '1196868007', '709284003', '431902003', '254795008', '1162859004', '404155008', '277796003', '1260180004', '254867003', '118613001', '93151007', '277568007', '1196864009', '134335004', '445406001', '718220008', '716859000', '1162799008', '1222643003', '715561008', '764961009', '1172704005', '773775004', '773774000', '109988003', '1255892003', '1255890006', '1255737000', '1255739002', '1255897009', '1255738005', '1255814001', '1255788002', '1255790001', '1255898004', '1255789005', '1255811009', '1255792009', '1255791002', '1255797003', '1255793004', '1255812002', '1255726001', '1255728000', '1255894002', '1255727005', '1255798008', '1255687003', '1255666008', '118605002', '1255784000', '1255786003', '1255785004', '1255888005', '1255743003', '1255745005', '1255883001', '1255744009', '1255808008', '118610003', '307633009', '188587006', '188591001', '188586002', '426885008', '188593003', '188592008', '307634003', '93493001', '93494007', '93495008', '188562004', '93500006', '277609007', '118609008', '188577007', '188580008', '188576003', '188582000', '93509007', '307635002', '118608000', '277612005', '277610002', '277611003', '188567005', '188570009', '188566001', '188572001', '93518009', '118602004', '188536008', '93530003', '93531004', '188541000', '93536009', '188529007', '188524002', '1255887000', '188531003', '118606001', '93547002', '93548007', '93549004', '188551004', '93554008', '417044008', '763719001', '278189009', '285420006', '285421005', '285422003', '441313008', '70910003', '403996004', '722958008', '404017001', '771233008', '764940002', '766707003', '715664005', '417619001', '1237341006', '416351002', '1157162007', '733834006', '416669000', '1231735008', '238862009', '277587001', '788972003', '1228861004', '1156795003', '1217490003', '1217617009', '354391000119100', '1156797006', '354461000119102', '16699241000119100', '72891000119103', '109385007', '703625002', '255114007', '255115008', '231835006', '109389001', '109390005', '109391009', '109392002', '109388009', '109386008', '188029000', '403978008', '420524008', '414553000', '313427003', '724649000', '702785000', '10737821000119106', '1081591000119101', '62557001', '447707005', '449055006', '763771009', '1156788007', '447804006', '770559003', '1156785005', '1156786006', '1137644008', '1144305001', '1144307009', '1144306000', '448229007', '699355007', '1144304002', '1144303008', '1156783003', '447706001', '10976631000119101', '716651004', '447785000', '447389009', '58961005', '404153001', '404139001', '93144003', '93145002', '93146001', '188648000', '188645002', '188649008', '93150008', '428850001', '373604002', '277579002', '400102008', '448554008', '254993006', '143411000119109', '1230002004', '63175003', '404120006', '783006001', '118607005', '1260090009', '1260091008', '239940004', '239297008', '31047003', '404103007', '404104001', '404105000', '404106004', '1255270006', '122491000119108', '771073006', '254290004', '716318002', '192681000119104', '123721000119108', '726654006', '123701000119104', '145298771000119104', '123661000119106', '793197981000119106', '123691000119104', '709830006', '783155007', '402873007', '443250000', '443439001', '254996003', '404014008', '773283006', '773284000', '770686005', '254995004', '254797000', '827162007', '278051002', '789689004', '878857009', '878858004', '789690008', '188668006', '118615008', '93200005', '93201009', '93202002', '1255899007', '1255809000', '698045009', '255021005', '255015006', '255004001', '255012009', '1080941000119109', '1080951000119106', '1080961000119108', '277530005', '783736003', '1080981000119104', '1080991000119101', '1081001000119100', '402561003', '1197334002', '789721005', '94281000119101', '422282000', '713572001', '1263450003', '254844000', '417554000', '416769008', '417417007', '444596001', '404150003', '443487006', '116871000119103', '441559006', '404172001', '110002002', '397011009', '1255729008', '188662007', '188669003', '1255730003', '763796007', '94148006', '63402005', '277527003', '404024000', '1157161000', '135931000119106', '133841000119105', '352071000119105', '133881000119100', '133851000119107', '351461000119100', '133861000119109', '133891000119102', '133871000119103', '1279882001', '1269121005', '1187463001', '770896003', '866052009', '1186735007', '1187123005', '1153381008', '1153377008', '1153379006', '1260202003', '445964006', '307340003', '768925009', '423793008', '423708008', '423424005', '277622004', '816204007', '61493004', '698770000', '30664006', '61808009', '721188000', '715907003', '94704006', '414785000', '447596005', '277589003', '398623004', '415283002', '415284008', '277597005', '721301004', '738527001', '1229988003', '724644005', '724642009', '94719007', '94718004', '1157159009', '403974005', '400175006', '253042009', '404046008', '404031001', '1197306009', '1156407001', '717916003', '1186869002', '716653001', '725167001', '1162856006', '785824001', '707625001', '707594002', '721194008', '717918002', '687061000119103', '255023008', '314514005', '687091000119105', '1217489007', '687101000119100', '687111000119102', '687121000119109', '687131000119107', '255000005', '687141000119103', '425327002', '687081000119107', '687151000119101', '448562000', '92503002', '726721002', '829971006', '1208744003', '116811000119106', '116821000119104', '448220006', '448254007', '277580004', '1187622004', '773641008', '773629001', '719045009', '307605009', '739301006', '425657001', '707430007', '707429002', '707529004', '404028002', '773642001', '1156457009', '1231180000', '254799002', '1260073003', '1254803009', '783056006', '237250000', '1208349005', '1153336009', '402911002', '716650003', '714251006', '712989008', '427942006', '1260182007', '398670003', '277507004', '788757008', '237252008', '724648008', '95210003', '122981000119101', '95209008', '415110002', '404071006', '398903003', '404054005', '404025004', '79268002', '762316003', '717921000', '277572006', '425941003', '1259430009', '1268563005', '1259774005', '1268710000', '721718003', '184781000119102', '128041000119107', '208041000119100', '721628002', '99101000119101', '724536000', '724537009', '10737401000119100', '721617001', '1259697004', '721623006', '721624000', '721669006', '733362008', '721557009', '10737361000119109', '184891000119109', '737308008', '737309000', '721622001', '91131000119109', '1268536009', '1268537000', '1259495001', '1259502006', '1259498004', '707484005', '707425008', '1268638003', '1268697005', '1259387001', '1268459000', '1259426006', '1268531004', '773624006', '1259724008', '1268719004', '682221000119103', '682231000119100', '682241000119109', '682251000119106', '1259773004', '682261000119108', '1268965008', '1259819000', '1196860000', '1259813004', '1268964007', '1268458008', '682271000119102', '682291000119101', '721576006', '682311000119102', '682321000119109', '721575005', '1079021000119102', '1079031000119104', '1079011000119109', '682361000119104', '682381000119108', '1079061000119107', '1079071000119101', '1079051000119105', '16091131000119108', '16091411000119109', '16091251000119109', '16091371000119108', '682411000119106', '682421000119104', '1259812009', '1268960003', '16774671000119108', '707481002', '707662004', '707579001', '1196856003', '766935007', '1259582008', '1268909004', '1268532006', '1259610003', '1259320001', '1268487009', '1259341007', '1268488004', '1259343005', '1259342000', '1268350000', '1268639006', '1269347008', '1268526001', '713325002', '1268461009', '1144891007', '721716004', '735679005', '1079561000119103', '1079571000119109', '1079581000119107', '1079551000119100', '723843005', '91081000119109', '91061000119100', '723846002', '1079611000119100', '1079621000119107', '1079631000119105', '1079601000119103', '91031000119108', '1079591000119105', '683121000119103', '1079641000119101', '16845381000119100', '1269046008', '130941000119107', '1259823008', '1259755002', '1259824002', '1259825001', '1259804001', '1208483002', '1268702001', '1268500006', '1259765008', '1268538005', '1268351001', '1268543003', '1268499002', '773995001', '128875000', '788674000', '765136002', '735332000', '1259381000', '404143002', '733627006', '404141000', '404140004', '404142007', '1196846002', '1196841007', '1269051002', '1269044006', '772992009', '1268961004', '1269048009', '1255190008', '713516007', '714463003', '1153348007', '1196839006', '1196881000', '721602000', '1268502003', '1259458001', '1268349000', '1268885006', '683761000119107', '683791000119100', '1259382007', '1196883002', '1259783000', '1268547002', '1268533001', '1080001000119106', '1080021000119102', '1079991000119101', '723853006', '1259615008', '723887001', '1080051000119105', '1080071000119101', '1080041000119108', '683981000119101', '1259616009', '1268534007', '1080031000119104', '1080081000119103', '1285706005', '1268956001', '1259786008', '707403002', '1259816007', '1269414003', '1186629001', '1259453005', '1259312003', '724650000', '84821000119100', '1255192000', '1268486000', '735757008', '1259456002', '1259801009', '1259802002', '1259814005', '1269050001', '1259815006', '1269049001', '1259781003', '1259766009', '1268631009', '1259722007', '16845341000119105', '1259744002', '16845301000119108', '684901000119107', '684911000119105', '684921000119103', '684931000119100', '1259723002', '684941000119109', '1268966009', '1259692005', '1268701008', '1259693000', '716652006', '1268711001', '1259580000', '1259782005', '420788006', '1268542008', '1259791009', '1186614003', '1186615002', '1186616001', '424779008', '1268906006', '1259613001', '1269052009', '423807009', '685571000119105', '685601000119104', '685611000119101', '685621000119108', '685641000119102', '1080551000119100', '1080561000119103', '1080571000119109', '1080581000119107', '1080541000119102', '685671000119109', '685691000119105', '685701000119105', '722514002', '722513008', '1080601000119103', '1080611000119100', '1080621000119107', '1080631000119105', '1080591000119105', '685721000119101', '685731000119103', '1268900000', '721578007', '722516000', '722515001', '685831000119105', '685851000119104', '685861000119102', '685901000119108', '1080691000119109', '1080701000119109', '1080711000119107', '1080681000119106', '721577002', '685921000119104', '685941000119105', '685951000119107', '1080731000119102', '1080741000119106', '1080751000119108', '1080721000119100', '685971000119103', '685981000119100', '1268640008', '707491008', '707360003', '1010607000', '707584007', '707493006', '421283008', '1268707007', '1231267007', '1268715005', '1259735003', '1259779000', '16636051000119105', '16823941000119108', '16636101000119105', '1268706003', '1268712008', '1268704000', '1259810001', '371987000', '369513003', '369520005', '1259828004', '1259830002', '1259831003', '1259832005', '1259829007', '722517009', '733163007', '721673009', '130381000119103', '721636006', '721635005', '721698005', '721626003', '737313007', '722528008', '721637002', '721700001', '721634009', '1237340007', '1268905005', '1259805000', '1268720005', '1259728006', '1269043000', '1268721009', '1284849005', '1260116000', '1268718007', '1268955002', '444910004', '1268716006', '1259725009', '1269412004', '1259784006', '1259718002', '1259719005', '1259788009', '1259717007', '1268539002', '1268637008', '1197283000', '1259395002', '1259827009', '1269045007', '1268898002', '721672004', '733361001', '1268546006', '1268641007', '1259497009', '1259505008', '1259500003', '1259676000', '307651005', '723076008', '1259601006', '1268714009', '1259807008', '1259806004', '1268519001', '1259425005', '1259457006', '721640002', '721639004', '721697000', '721625004', '1197307000', '721642005', '721641003', '721701002', '721638007', '716588005', '1268485001', '1259370003', '1237578005', '1268528000', '1268717002', '1259730008', '1259798003', '687331000119109', '687351000119103', '1259732000', '687361000119101', '1268462002', '1259641002', '1259623005', '723848001', '1081281000119102', '1081291000119104', '1081301000119103', '1081271000119100', '723850009', '1259643004', '1081331000119105', '1081341000119101', '1081351000119104', '1081321000119107', '1259645006', '1081311000119100', '687401000119105', '440397000', '1081361000119102', '1259646007', '1259796004', '1268908007', '1259797008', '1259795000', '1268911008', '1268503008', '707482009', '707426009', '707581004', '1255191007', '1255194004', '1269047004', '1259429004', '1268460005', '1259428007', '1259790005', '1268703006', '1269413009', '1259818008', '1268888008', '1268957005', '1268352008', '1259789001', '1259817003', '1268899005', '1268962006', '1268959008', '1268958000', '1269042005', '1268902008', '718200007', '1268642000', '1268901001', '687771000119106', '687791000119107', '687801000119108', '1162284007', '687811000119106', '687821000119104', '687841000119105', '722512003', '1081631000119101', '1081611000119106', '721574009', '1162282006', '687861000119109', '722509001', '687881000119100', '687891000119102', '722510006', '722511005', '1081671000119103', '1081651000119107', '687911000119100', '687921000119107', '1268548007', '1197259008', '1081781000119105', '1081811000119107', '722680009', '1268561007', '15955941000119102', '1081841000119106', '1081891000119103', '1268348008', '1081911000119101', '1268540000', '15955901000119104', '1081861000119105', '1081921000119108', '67811000119102', '67821000119109', '67831000119107', '67841000119103', '1268518009', '1268698000', '1268700009', '1259583003', '707489000', '707422006', '707582006', '722542000', '707537007', '688711000119104', '722672002', '1268635000', '688781000119105', '733359005', '1197275006', '1268632002', '707664003', '707697002', '707492001', '707357005', '707358000', '707535004', '733344004', '1268541001', '688891000119103', '688901000119104', '688911000119101', '1229871006', '733343005', '707585008', '18121000119104', '733134009', '722674001', '707703001', '707686002', '707532001', '707704007', '1268633007', '16218761000119102', '1268636004', '1268634001', '707576008', '737311009', '737310005', '707575007', '689361000119108', '689371000119102', '707538002', '242951000119108', '689481000119107', '689491000119105', '689501000119103', '1259780002', '1268484002', '722828003', '722827008', '721579004', '1268897007', '1259427002', '722670005', '1259737006', '1268545005', '1268501005', '1268387008', '733360000', '1268389006', '1268391003', '1268396008', '707490009', '707427000', '716862002', '783138008', '307601000', '722957003', '1217383007', '452291000124109', '415287001', '830057003', '713483007', '420302007', '403982005', '278024000', '763408003', '763409006', '1255385002', '1162286009', '1162280003', '1255628005', '254994000', '10737781000119101', '1081601000119108', '399660006', '783183009', '449166001', '688141000119104', '688101000119101', '688121000119105', '688131000119108', '688151000119102', '688161000119100', '688171000119106', '688181000119109', '688191000119107', '688111000119103', '255001009', '1196865005', '426510004', '781641005', '404068003', '788758003', '818962009', '1208745002', '1230318000', '768924008', '702406000', '1255799000', '1255801002', '1255800001', '118611004', '188632001', '188635004', '188631008', '188633006', '188634000', '188637007', '95263006', '438946002', '440501006', '439478008', '1208741006', '413587002', '1231732006', '404030000', '426336007', '404073009', '404055006', '1255632004', '1254806001', '763884007', '763666008', '254886006', '764737005', '408648004', '276804009', '770602005', '1260079004', '1254852008', '405822008', '1254800007', '255071008', '418372008', '419240004', '423464009', '403468003', '1254805002', '285308002', '285307007', '1260084005', '403890009', '62497000', '15629411000119106', '403973004', '404015009', '721311006', '397015000', '427642009', '724645006', '699818003', '277567002', '898198006', '255106001', '1144928005', '1144922006', '1144924007', '277185000', '444374006', '1264416003', '1279841001', '780817000', '370511006', '46659004', '276873004', '276874005', '276875006', '399933001', '403475002', '403476001', '402912009', '766759009', '190818004', '717922007', '404081005', '1197280002')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.d9d55b67-2a18-4eaf-bce8-d6e747d1915b"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_neoplastic_disease=Input(rid="ri.foundry.main.dataset.c014ecff-0613-48b2-8a3b-eb75cd026ab0")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_neoplastic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.9f2dfa46-9b4d-4de8-9595-98b9e70b7171"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_neoplastic_disease_data=Input(rid="ri.foundry.main.dataset.d9d55b67-2a18-4eaf-bce8-d6e747d1915b")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('C45.1', 'D47.5', 'C57.0', 'C82.6', 'O01.1', 'O01.0', 'C84.6', 'C84.7', 'C90.1', 'C51.8', 'C88.0', 'C83.1', 'C88.4', 'C96.8', 'C94.4', 'C92.8', 'C86.4', 'C91.6', 'C86.5', 'C86.2', 'C86.1', 'C86.0', 'C92.6', 'C92.5', 'C94.6', 'C92.2', 'C94.3', 'C81.2', 'C81.1', 'C81.3', 'C81.4', 'C86.6', 'E34.0', 'C90.3')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_neoplastic_disease_data
) as rare_neoplastic_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.9ae5155c-8f65-472f-896f-cd10ecb9b1bb"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_neurologic_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('719574007', '773494008', '880093002', '1229883008', '1222671009', '1222672002', '890123006', '303098002', '733637001', '733636005', '1208933000', '725289009', '768555009', '1229875002', '773493002', '230648001', '230679002', '783161005', '715793003', '230671004', '718573009', '230438007', '435321000124106', '435331000124109', '702349003', '764453009', '191692007', '1197757006', '83942000', '182961000119101', '766044005', '72986009', '1187643003', '63081009', '716723000', '715770009', '716722005', '68577004', '230378004', '430042004', '783244002', '766049000', '47000000', '722985001', '783258000', '15285008', '1172694007', '13980006', '766824003', '1259068001', '62009002', '448054001', '785302009', '783242003', '770792007', '720466001', '1259061007', '1231749004', '1259072002', '85505000', '722281001', '774068004', '230312006', '1187045009', '1187046005', '1187047001', '1187048006', '1187049003', '230301006', '81854007', '1237515001', '702327009', '788417006', '783770002', '230466004', '67845009', '702437000', '1197155007', '398229007', '838276009', '1259123006', '1259121008', '722987009', '1201863001', '1208412003', '1201950008', '784341001', '1204334005', '1204349002', '1204350002', '1204351003', '1259126003', '1259127007', '230258005', '1259124000', '1259125004', '1259122001', '1259129005', '702439002', '422348008', '76880004', '1162462009', '787175002', '720494009', '1259558003', '1259119003', '405755009', '405756005', '282785008', '721380000', '721381001', '721382008', '721383003', '721384009', '721385005', '721386006', '721387002', '721388007', '721511007', '721512000', '721513005', '721514004', '721515003', '721516002', '721455004', '721465005', '721466006', '721467002', '721456003', '721457007', '721458002', '721459005', '721460000', '721461001', '721462008', '721463003', '721464009', '1269375005', '1269376006', '1269380001', '1269389000', '212186005', '1222706005', '195373009', '14363008', '302661000119103', '302681000119107', '302701000119105', '302711000119108', '212172006', '212178005', '720498007', '36785009', '8217007', '238031009', '724769002', '768556005', '700058006', '68504005', '763065008', '783203003', '702442008', '720518006', '789657008', '720520009', '231536004', '1156791007', '725146001', '1186856001', '1156790008', '718393002', '765216006', '733623005', '1259105003', '765751002', '715863001', '838323002', '784391002', '1156789004', '1156800008', '1156798001', '1197523001', '1201861004', '716696006', '722293005', '717016001', '764850002', '717008005', '717010007', '717011006', '1187620007', '1172684002', '764730007', '1187566006', '717012004', '719510006', '719511005', '717013009', '717014003', '719512003', '719513008', '719514002', '719515001', '782829002', '773393001', '765046002', '1187618009', '1172634009', '782742006', '1187565005', '1187564009', '763067000', '1208415001', '1202024009', '1208418004', '1179294000', '715768000', '1010712009', '784377008', '719516000', '230319002', '765744006', '765745007', '765746008', '765747004', '722294004', '770759001', '778003000', '716662004', '719985001', '719987009', '719989007', '719990003', '1222644009', '725903003', '698021005', '442161000124105', '442151000124108', '778070003', '764854006', '784380009', '732948003', '763374004', '783698005', '230263009', '763375003', '733029008', '782670003', '763068005', '723819007', '763369007', '783622001', '723820001', '763069002', '763070001', '732949006', '1187468005', '785305006', '1187465008', '1187466009', '725392005', '1197524007', '725394006', '1187619001', '711406009', '1201862006', '240081004', '725433003', '1237625002', '782719004', '782721009', '773498006', '770898002', '783060009', '763312008', '763348005', '715366004', '725408001', '766814006', '715369006', '776087007', '725047007', '770404004', '1186734006', '1208414002', '1202025005', '1208417009', '770430000', '715827001', '1156848009', '230320008', '773308001', '773330000', '773414009', '1187567002', '1222704008', '771476007', '715341003', '718179003', '718176005', '715340002', '718850008', '718177001', '720522001', '718180000', '725042001', '720523006', '726616006', '726618007', '726617002', '725043006', '726614009', '726615005', '732929002', '732930007', '783554002', '725907002', '771302009', '764812008', '724065003', '715981004', '702445005', '784347002', '784343003', '715491000', '783094006', '764686003', '732932004', '764734003', '726608002', '785304005', '732933009', '726607007', '778030005', '763376002', '726606003', '764688002', '719103009', '764736001', '723821002', '765753004', '723822009', '763367009', '723823004', '723824005', '723825006', '783764008', '723826007', '770720005', '773425000', '763373005', '782746009', '726611001', '765045003', '726610000', '726609005', '782747000', '766767001', '782725000', '770724001', '782726004', '1187191003', '1187470001', '1172631001', '1187506008', '1177168007', '1187467000', '1204415006', '763377006', '782727008', '403815003', '91952008', '91953003', '91954009', '91955005', '91956006', '765212008', '230380005', '425892007', '430904007', '387732009', '715465001', '716994006', '717225001', '434551000124106', '434541000124109', '240078009', '1237571004', '770405003', '1231282002', '230652001', '715425000', '230306001', '770622009', '765756007', '68267002', '1263549001', '698838008', '1263546008', '698839000', '1263545007', '1263547004', '230256009', '1263539004', '1263540002', '230410004', '771304005', '230411000', '230387008', '431971000124106', '431961000124104', '230388003', '770623004', '425868004', '763127004', '719521002', '770624005', '771141002', '44145005', '770787005', '732959007', '718572004', '427086003', '16907601000119106', '16638321000119100', '16005311000119104', '703522009', '72893007', '1145216001', '1145219008', '16005271000119104', '12236641000119103', '12236681000119108', '27830001', '1259051000', '720576001', '28188001', '5202009', '13752003', '9015001', '33332005', '53267002', '127305005', '78968003', '78028004', '66393002', '52888005', '79220008', '29807001', '127307002', '874940002', '874943000', '12589008', '41222005', '3119002', '19210000', '20899000', '703530005', '699866005', '230253001', '399165002', '262692002', '1179295004', '1172595004', '1279886003', '715624006', '703532002', '230293003', '726704006', '1197429000', '711265009', '405757001', '405758006', '282787000', '721372007', '721373002', '721374008', '721375009', '721376005', '721377001', '721378006', '721379003', '721505009', '721506005', '721507001', '721508006', '721509003', '721510008', '721442000', '721452001', '721453006', '721454000', '721443005', '721444004', '721445003', '721446002', '721447006', '721448001', '721449009', '721450009', '721451008', '43152001', '1269377002', '1269381002', '1269392001', '1269390009', '212187001', '212173001', '212179002', '720634003', '717332007', '763344007', '1236804009', '1217230002', '127304009', '82344002', '86125000', '19233004', '57739006', '32415004', '17169009', '241994005', '1237475006', '127306006', '262687004', '874939004', '30858001', '59918000', '84900008', '14434006', '30031007', '90429009', '390936003', '703219008', '46966000', '874937002', '241993004', '206238001', '711403001', '206196005', '450418003', '240312009', '269144002', '275382005', '711482008', '405759003', '764661000000103', '763136000', '725048002', '719981005', '771307003', '720637005', '782826009', '774147002', '1187617004', '1187128001', '715796006', '715803003', '715800000', '763345008', '715797002', '715798007', '763135001', '715801001', '715799004', '715802008', '720638000', '40632002', '42986003', '4183003', '719979008', '715666007', '719980006', '50866000', '71961003', '787172004', '785301002', '1172584005', '1172602000', '1167373005', '1197154006', '1187251009', '773492007', '26848004', '724765008', '1197758001', '716771000', '1259636005', '128209004', '230564004', '773688007', '95654002', '1187004001', '722986000', '1186861004', '840452004', '768663003', '1172691004', '763130006', '16001951000119102', '16001911000119103', '870551001', '870550000', '698621006', '698620007', '53868003', '50888000', '8459005', '51514006', '8840000', '31235003', '78157002', '66158003', '35403005', '46995009', '81442004', '207998001', '49747005', '870549000', '870548008', '14493003', '52289006', '13456001', '31033002', '31882001', '13194006', '8183009', '18960007', '41133002', '72513001', '44434003', '22383006', '698617004', '22973003', '209049001', '209083008', '209050001', '209084002', '209048009', '209082003', '209077005', '209051002', '209085001', '208001004', '208007000', '208057008', '208029001', '208035001', '208058003', '208000003', '208006009', '208056004', '208028009', '208034002', '208003001', '208009002', '208059006', '208031005', '208037009', '209146005', '209179005', '209147001', '209180008', '209145009', '209178002', '209148006', '209181007', '1230376005', '785299009', '732264002', '1259562009', '778060000', '702363009', '783180007', '1279845005', '405760008', '405761007', '721529002', '721362009', '721363004', '721364005', '721365006', '721366007', '721367003', '721368008', '721369000', '721370004', '721499008', '721500004', '721501000', '721502007', '721503002', '721504008', '721429000', '721439006', '721440008', '721441007', '721430005', '721431009', '721432002', '721433007', '721434001', '721435000', '721436004', '721437008', '721438003', '1269379004', '1269383004', '212185009', '739665005', '447575003', '447464004', '212171004', '212177000', '128200000', '734987002', '734989004', '734988007', '734986006', '712537009', '734947007', '408751001', '408749000', '291781000119103', '291761000119107', '291791000119100', '291771000119101', '408750000', '293951000119107', '293921000119104', '293931000119101', '293941000119105', '293961000119109', '293971000119103', '212356007', '447396006', '737233008', '737238004', '722995008', '737236000', '76418009', '734031008', '1237626001', '773398005', '399040002', '1177169004', '715436007', '733111000', '733112007', '733115009', '230673001', '230677000', '1208413008', '1209168005', '1202023003', '1208416000', '1201964008', '1174000008', '1279831004', '1279834007', '1237623009', '722390006', '773306002', '782757004', '1259560001', '771272007', '725420009', '1172688004', '764944006', '783176002', '763314009', '715429006', '771267003', '783174004', '783175003', '230672006', '240084007', '764945007', '763315005', '1255274002', '57938005', '20305008', '720830009', '128206006', '770408001', '763218005', '764946008', '773415005', '34663006', '722908001', '84170006', '90768003', '722907006', '23713006', '262689001', '870563006', '262697008', '870540001', '870565004', '10943471000119107', '262699006', '10943311000119108', '262700007', '262696004', '262698003', '87888006', '73413009', '81412002', '209845006', '32106001', '16319002', '17498002', '127303003', '262688009', '59748008', '69875006', '41870008', '209864000', '1230018005', '1259634008', '783179009', '860826006', '1163119007', '725097006', '721333008', '778063003', '230419003', '230416005', '773230003', '764525006', '720825005', '1172625004', '733071009', '230678005', '444944006', '124427009', '709282004', '124224004', '124704002', '124432005', '124667004', '111499002', '733185001', '68116008', '733044009', '770627003', '715646003', '770790004', '229703009', '766871009', '782737003', '771261002', '783166000', '763533003', '770630005', '1230343006', '1197152005', '771081007', '58795000', '111506000', '193230001', '702383005', '726107008', '782675008', '733489002', '765196004', '783148005', '230247001', '783057002', '1187621006', '1236845001', '722763000', '449899001', '76670001', '230782004', '722435003', '1281844004', '702448007', '782718007', '1260391004', '230429005', '44423001', '430071000124102', '430061000124109', '1222661007', '230228004', '773548008', '733082001', '1236844002', '702343002', '716107009', '1172588008', '771514002', '771469002', '230450001', '56989000', '292991000119106', '608874000', '240063002', '403819009', '111508004', '1237511005', '1236807002', '720864008', '230360009', '733031004', '733032006', '230439004', '716278005', '230422001', '230421008', '721975004', '421182009', '420932006', '718755009', '718754008', '718756005', '718753002', '718752007', '773495009', '294031000119103', '723307008', '1237338002', '28155008', '768926005', '771179007', '1172701002', '723306004', '399091004', '230249003', '230250003', '110997000', '275362006', '723359002', '715829003', '721219005', '230265002', '42295001', '9133005', '41590007', '4463009', '5134006', '402460000', '703226008', '778061001', '784348007', '763770005', '715807002', '721220004', '29159009', '763352005', '702421006', '782756008', '764522009', '95656000', '1260329005', '1260330000', '1260327007', '304737009', '82732003', '230670003', '784342008', '1231183003', '784372002', '765202001', '783257005', '1003465006', '783739005', '778029000', '83157008', '782883004', '774206008', '702419001', '725413002', '774151000', '720954000', '23820006', '763718009', '1767005', '10941261000119103', '788930004', '210038008', '788934008', '788931000', '788932007', '788933002', '765089003', '722615007', '722625002', '722702007', '722616008', '240119009', '722622004', '722618009', '722614006', '722624003', '722620007', '722623009', '722619001', '720956003', '717276003', '702450004', '274156000', '274158004', '274157009', '263179007', '1734006', '448045004', '10394003', '715629001', '699688008', '444451000124106', '444441000124109', '230669004', '67155006', '128207002', '1172630000', '43763009', '399044006', '445252005', '63329001', '1281842000', '717822006', '1260195002', '1186713004', '719972004', '719395001', '721008000', '14070001000004105', '443095000', '724383002', '15630241000119104', '15630201000119101', '737582007', '230407006', '59292006', '124051000119100', '722453009', '57835009', '702428000', '56453003', '45639009', '724357007', '1231178006', '702427005', '230557001', '718103001', '724351008', '724349009', '770786001', '62985007', '230558006', '715665006', '771143004', '771144005', '128203003', '702373006', '403775003', '782881002', '783198006', '717825008', '1279838005', '783550006', '1172838005', '397734008', '398148000', '717826009', '717827000', '860813007', '860814001', '860811009', '860812002', '860809000', '860810005', '1254941001', '715645004', '209900006', '1003584006', '209902003', '763534009', '25362006', '1186724002', '784371009', '721228006', '770939009', '782743001', '58756001', '1260338007', '78071008', '33116002', '768554008', '763721006', '1177177000', '773665006', '724283004', '721846006', '766931003', '777999008', '14900002', '766932005', '264534009', '56271007', '763722004', '703304005', '715662009', '715534008', '403779009', '778050009', '230318005', '442416002', '442292004', '230321007', '763739002', '425756000', '230537000', '762282007', '702382000', '703544004', '72315009', '722654008', '739666006', '8939001', '83991006', '11413003', '63903007', '724274009', '1259106002', '703543005', '782822006', '770725000', '724228005', '771223000', '1156826003', '1217371005', '52713000', '58258004', '785300001', '1260129000', '1172603005', '773421009', '724227000', '770438007', '432249006', '766706007', '782887003', '213383004', '24392008', '11807002', '53810004', '698783004', '698404009', '25331007', '1260357003', '1260359000', '722576009', '10938941000119103', '722653002', '212357003', '723155001', '721428008', '726709001', '1187210007', '1197593006', '773552008', '787174003', '722455002', '770755007', '774203000', '773405004', '1197156008', '127309004', '127310009', '78879009', '124041000119102', '124061000119103', '768934004', '206398001', '80138003', '230733004', '773990006', '766710005', '230328001', '1187126002', '1208747005', '771470001', '721875000', '230413002', '1259108001', '718555006', '1201947005', '1201961000', '6204001', '435361000124100', '39925003', '61663001', '230299004', '193207007', '766252004', '717964007', '716112005', '778001003', '111488004', '763776004', '723992000', '54280009', '86188000', '1172590009', '1172591008', '78914008', '22819008', '55702009', '262691009', '262706001', '262708000', '262709008', '262705002', '262707005', '230425004', '764859001', '1279883006', '1263562002', '14637005', '770558006', '230300007', '1259536000', '16005191000119106', '12242071000119103', '230418006', '431121000124107', '431111000124104', '1269342002', '1269343007', '1269385006', '763346009', '1197587003', '764095005', '719403003', '733452000', '763366000', '1186710001', '719405005', '1234819007', '716684004', '38023001', '716380002', '783618006', '721974000', '212183002', '724995009', '716023007', '718175009', '230255008', '782739000', '213026003', '784345005', '766246000', '386766007', '80734006', '724172004', '1230273004', '703536004', '230325003', '717968005', '1236805005', '111503008', '770643005', '766715000', '24326000', '40802007', '297278001', '1003375005', '44359008', '47683004', '83832001', '1187195007', '723404002', '1208348002', '725461009', '770564004', '770565003', '1220596009', '765758008', '715482004', '770655004', '719380003', '764732004', '719394002', '763798008', '733472005', '733092009', '733604003', '719377004', '719378009', '719379001', '703369003', '1279889005', '721903007', '1254651003', '773305003', '723304001', '770721009', '715462003', '1003373003', '763802009', '237351003', '785809005', '709415008', '715533002', '724174003', '763803004', '230591002', '724097003', '69116000', '718551002', '778048001', '55133004', '432451000124103', '403816002', '722626001', '722617004', '1208620009', '403817006', '46549005', '230297002', '444024002', '444197004', '722633001', '785298001', '764992006', '237611007', '723407009', '91637004', '31839002', '230685009', '16415791000119104', '55051001', '77461000119109', '77471000119103', '80976008', '1187144005', '431141000124100', '438421000124109', '439732004', '192990004', '778047006', '230426003', '783722008', '724095006', '764994007', '240087000', '763895001', '699267007', '726051002', '715788001', '715789009', '735676003', '91521000119104', '723439002', '1237462006', '129622008', '277480002', '770664009', '1186718008', '1222662000', '1156803005', '82178003', '1208339007', '77817004', '16057351000119103', '292491000119101', '16057391000119108', '292481000119104', '26609002', '724091002', '699299001', '715344006', '92824003', '237984008', '1208615009', '15244003', '766752000', '25044007', '703526007', '715437003', '699315005', '770758009', '766753005', '1217379007', '230496009', '230464001', '237939006', '303092001', '303093006', '723441001', '1220598005', '1230017000', '1187038009', '15978511000119100', '313304007', '1172586007', '230684008', '414927004', '722056009', '722055008', '77097004', '230252006', '763829004', '722064003', '30371007', '21978005', '61386002', '10310006', '33147008', '76435008', '43405004', '74360009', '20377001', '66020004', '80980003', '125609005', '208012004', '448788000', '48956000', '111633007', '870555005', '870556006', '49497005', '63819001', '85262003', '16695002', '27937002', '88405003', '78085003', '51258005', '3446000', '78211006', '870554009', '870553003', '698619001', '698618009', '10575009', '209067008', '209098005', '209068003', '209100005', '209066004', '209097000', '209092006', '209069006', '209101009', '208064005', '208043006', '208022005', '208065006', '208014003', '208020002', '208063004', '208042001', '208048002', '208017005', '208023000', '208066007', '208045004', '208051009', '209163009', '209194009', '209164003', '209195005', '209162004', '209193003', '209165002', '209196006', '230350000', '763827002', '763837007', '15552004', '1156768008', '763861000', '41574007', '1231185005', '445423005', '766722008', '783012006', '72585000', '766872002', '715737004', '715564000', '724072002', '699190008', '443094001', '609221008', '609218006', '773497001', '1197363004', '446682003', '1186728004', '64855000', '87607002', '59636002', '1003881009', '1003447007', '126945001', '276593000', '774154008', '774153002', '766815007', '765325002', '782752005', '723497003', '724067006', '699184009', '609529006', '785723001', '193206003', '1187529000', '783010003', '718603002', '95208000', '2992000', '1177165005', '1172703004', '447288004', '1167371007', '718213001', '723452007', '770679002', '1279884000', '1173997008', '773627004', '277478008', '19972008', '405765003', '405764004', '721389004', '721390008', '721391007', '721392000', '721393005', '721394004', '721395003', '721396002', '721397006', '721517006', '721518001', '721519009', '721520003', '721521004', '721522006', '721468007', '721478005', '721479002', '721480004', '721469004', '721470003', '721471004', '721472006', '721473001', '721474007', '721475008', '721476009', '721477000', '715574002', '1269378007', '1269382009', '1269393006', '1269391008', '212188006', '212174007', '212180004', '17974002', '1173998003', '18260003', '60401000119104', '31097004', '773275000', '1186863001', '698687007', '75023009', '372477008', '1217211002', '1186723008', '716664003', '782695002', '1220573009', '719278006', '715777007', '719276005', '403390002', '789063000', '81211007', '782825008', '782755007', '715902009', '723124007', '715627004', '716281000', '22451001', '723138000', '733422008', '774069007', '230246005', '719267003', '230240004', '1208481000', '770678005', '442511009', '1260130005', '718224004', '783064000', '783055005', '783062001', '1208939001', '783139000', '1228857005', '763349002', '771305006', '1217226000', '192976002', '1156763004', '1156764005', '1156761002', '770722002', '1197756002', '715317001', '1222657001', '230674007', '1186852004', '733086003', '1197149002', '1187043002', '724039002', '427972000', '721887007', '1260097007', '768473009', '84438001', '230676009', '724576005', '734434007', '26037005', '1230019002', '722660008', '763869003', '719162001', '702323008', '773772001', '1220600004', '230191005', '435341000124104', '715794009', '782696001', '2701000124105', '1172698005', '42779002', '16206661000119108', '91012008', '191693002', '783787000', '68618008', '700467001', '46826000', '57803009', '123950001', '782941005', '16005231000119102', '12242111000119105', '709281006', '770596007', '1222659003', '1231737000', '765093009', '45853006', '4260009', '230314007', '43226001', '230251004', '230248006', '49692006', '29145002', '57917004', '403391003', '1208841001', '770683002', '723139008', '230538005', '715464002', '1010653007', '723994004', '721207002', '717266001', '45116002', '292971000119105', '371089000', '1197157004', '766977007', '1172629005', '1187212004', '1208727002', '774149004', '782723007', '770751003', '230437002', '432171000124102', '771303004', '773555005', '1179282009', '237352005', '722213009', '722212004', '46804001', '725058003', '1284851009', '782824007', '1255323007', '763669001', '28534004', '79591004', '715504003', '763403007', '733455003', '1260134001', '733089005', '763402002', '725139005', '715776003', '726622002', '732958004', '763351003', '765092004', '68390005', '426055002', '771238004', '110150000', '241992009', '90584004', '698500002', '212194003', '26738009', '206223002', '277326006', '206224008', '312837005', '723612001', '128212001', '772129007', '703524005', '711483003', '770727008', '312786001', '312788000', '715748006', '715754007', '719207000', '719208005', '719209002', '719210007', '716724006', '719249005', '719250005', '719251009', '715751004', '718771009', '718774001', '718772002', '718770005', '718769009', '719252002', '715824008', '715825009', '719253007', '715826005', '719254001', '719300001', '711158005', '719301002', '734021001', '715755008', '734020000', '1208512000', '1208513005', '1208516002', '1279840000', '1279839002', '719302009', '715752006', '715726000', '715753001', '765091006', '80544005', '16476681000119105', '734023003', '713060000', '1177062005', '783705006', '1144926009', '763632004', '77956009', '771271000', '5217008', '733072002', '768666006', '277189006', '83982007', '230379007', '206399009', '230719004', '262955000', '5251007', '48518008', '75507000', '276278003', '276282001', '276284000', '276286003', '276280009', '276277008', '276281008', '276283006', '276285004', '703174002', '206188000', '43262000', '76896001', '18615009', '733200004', '765047006', '719164000', '765197008', '230420009', '230417001', '1222656005', '1172626003', '723557004', '763622006', '773554009', '212169004', '1268463007', '30967002', '698846009', '262711004', '262713001', '262714007', '262710003', '262712006', '230683002', '870364001', '127295002', '708728007', '127298000', '127300000', '127302008', '127301001', '230763008', '311826007', '737234002', '737239007', '737237009', '230282000', '262695000', '262694001', '737232003', '722632006', '722631004', '722575008', '722630003', '737231005', '762362006', '762363001', '446835008', '446644006', '445779008', '371050006', '722703002', '10941651000119102', '10941451000119104', '83716008', '262718005', '146251000146109', '262721007', '329671000119106', '782935003', '230264003', '447253004', '230368002', '230369005', '230370006', '230371005', '1197153000', '240062007', '230423006', '60952007', '1251449006', '359686005', '447351004', '721165001', '304603007', '230741004', '212142000', '193010006', '193497004', '1187249005', '64383006', '724779000', '716335003', '763455008', '763457000', '763458005', '763400005', '763347000', '771148008', '719836007', '766764008', '698279003', '1156836006', '719838008', '719827008', '1254654006', '1197588008', '719815005', '773729007', '766818009', '770757004', '827172005', '784352007', '719816006', '725163002', '783697000', '723622007', '763370008', '764711007', '771475006', '715345007', '34513009', '718880003')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.a9cac60f-cc93-46fe-95b6-e641be966211"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_neurologic_disease=Input(rid="ri.foundry.main.dataset.9ae5155c-8f65-472f-896f-cd10ecb9b1bb")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_neurologic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.be5bfeb6-e7b9-4043-92b4-26ed3beb15aa"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_neurologic_disease_data=Input(rid="ri.foundry.main.dataset.a9cac60f-cc93-46fe-95b6-e641be966211")
)
-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data 
    where condition_source_value in ('F84.2', 'G10', 'F84.3', 'G60.1', 'G90.1', 'T88.3', 'G70.0', 'F84.1', 'G40.8', 'G23.1', 'P91.6', 'G23.0', 'I67.5', 'G37.1', 'G14', 'G23.3', 'G37.5', 'G24.1', 'G47.4', 'G93.2', 'T57.2', 'P94.0', 'G96.0', 'G70.2', 'G36.0', 'G37.0', 'G73.1', 'G12.0', 'G21.3', 'G21.0', 'F80.3', 'G23.2', 'G90.5', 'G90.6')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_neurologic_disease_data
) as rare_neurologic_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.d11d8849-1019-4078-ac1d-e4d4f95e654d"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for " Rare_odontologic_disease" rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED'  and concept_code in ('699382004', '707607008', '707608003', '109471001', '109472008', '234965004', '234966003', '109475005', '234961008', '234963006', '234962001', '109476006', '109473003', '109474009', '234964000', '14901003', '109444001', '109443007', '783059004', '719468005', '715527006', '109494000', '770943008', '234968002', '234969005', '234970006', '721089006', '1279835008', '109477002', '715634002', '707796002', '414342007', '716008002', '719687007', '722449007', '717823001', '109478007', '773692000', '773345007', '279309008', '63890001', '1231153007', '66063001', '699756005', '726672000', '733468006', '773302000', '733072002', '719911000', '716195006', '1003388008')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.ba26a0b9-a7d9-4099-9f10-ab650b3db579"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_odontologic_disease=Input(rid="ri.foundry.main.dataset.d11d8849-1019-4078-ac1d-e4d4f95e654d")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_odontologic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.80a26cd8-3940-431a-95d1-376b6dcabcd0"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_odontologic_disease_data=Input(rid="ri.foundry.main.dataset.ba26a0b9-a7d9-4099-9f10-ab650b3db579")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data 
    where condition_source_value in ('K03.5')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_odontologic_disease_data
) as rare_odontologic_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.725cab03-9ce8-45c9-8531-f16501ea1ccd"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_ophthalmic_disorder " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('716099003', '711644007', '783612007', '1208910001', '720460007', '312947009', '314006008', '1493002', '348831000119103', '348381000119107', '1208900005', '1234824005', '314545009', '51604006', '312929003', '719755001', '232049001', '725168006', '720983002', '715656004', '413583003', '724769002', '403434009', '312921000', '715339004', '719431007', '770791000', '719517009', '717975006', '717336005', '715374003', '716197003', '232052009', '773727009', '711162004', '723828008', '770404004', '1197358003', '1197151003', '771476007', '783065004', '724065003', '232053004', '1177028005', '410472006', '715465001', '719520001', '763387005', '312927001', '1099241000119105', '15989831000119105', '346731000119106', '15665801000119104', '346721000119108', '346711000119101', '681041000119106', '890381000', '840479000', '346701000119104', '346691000119104', '349281000119109', '15692681000119101', '15863931000119108', '15681681000119107', '890348001', '890349009', '680291000119102', '15992551000119106', '680491000119103', '746913791000119104', '561258721000119104', '345141000119109', '15992711000119104', '432521000124106', '344891000119109', '679201000119108', '890363003', '897585008', '344191000119100', '343791000119101', '343771000119102', '343761000119108', '343751000119106', '343741000119109', '679691000119100', '343461000119102', '343311000119109', '679211000119106', '679871000119102', '231981005', '413665004', '715391004', '890180006', '717914000', '717915004', '715647007', '725590001', '413746000', '312935003', '312940006', '722382006', '726704006', '718851007', '231996009', '419074008', '721535002', '312997008', '232040002', '312998003', '232039004', '232038007', '15997631000119103', '15997671000119100', '15997591000119103', '314009001', '432141000124105', '392481002', '717761005', '719808002', '312923002', '314007004', '13978000', '15678441000119103', '15678481000119108', '1217670003', '314546005', '1169360001', '732247000', '404633004', '1179296003', '719455002', '840486008', '715769008', '253224008', '342911000119104', '341481000119107', '335871000119105', '204138006', '28550007', '773648002', '717812000', '732952003', '1279837000', '341471000119109', '335861000119104', '773398005', '1260140008', '719102004', '722378009', '722379001', '342831000119100', '66499004', '679911000119104', '679931000119109', '58882000', '315297006', '74969002', '26590002', '20392000', '360429003', '400947008', '400946004', '416633008', '417395001', '204128001', '95488001', '204139003', '314508003', '341451000119100', '335841000119103', '1217207008', '1230020008', '890396001', '786076007', '348601000119109', '348151000119103', '253223002', '253225009', '342821000119103', '341441000119102', '335831000119107', '12235681000119102', '12235721000119108', '400945000', '702359002', '76562003', '253226005', '400953008', '29590001', '1204418008', '21590003', '720750004', '373425009', '15685121000119100', '15685081000119102', '773577009', '204127006', '722381004', '416296007', '1217674007', '1119281000', '231907006', '15692641000119106', '15692601000119109', '193411004', '414061000', '722432000', '699867001', '1230014007', '60318001', '340941000119101', '335331000119104', '128082002', '128083007', '128084001', '414063002', '54122009', '722437006', '722439009', '5361003', '1231258007', '1231280005', '1231260009', '314548006', '1231279007', '1847009', '860836003', '15681721000119101', '15681561000119104', '15665161000119108', '15665121000119103', '373426005', '715908008', '1197416000', '1231276000', '1237337007', '782949007', '770728003', '770434009', '1197365006', '782679002', '232063007', '1172636006', '417183007', '782754006', '778042000', '254150007', '193839007', '11226001', '340671000119102', '335061000119105', '770437002', '414303007', '314558005', '1176990003', '419900000', '719976001', '1285506008', '71111008', '231858009', '28438004', '419039007', '397568004', '717286002', '205548006', '724384008', '400014002', '427115009', '59523007', '397571007', '397570008', '417091001', '424801004', '422666006', '424435009', '702381007', '25362006', '1003424006', '721015008', '702398007', '721233005', '733113002', '723364003', '312931007', '773994002', '773993008', '773992003', '1231240001', '1231757001', '766933000', '773991005', '778049009', '1187510006', '312924008', '314008009', '721261004', '414491002', '771232003', '788963006', '866133000', '789116000', '89114005', '726709001', '1163460006', '1231665007', '15992591000119101', '15992511000119105', '1156827007', '129623003', '680511000119108', '680501000119105', '15678801000119102', '15678761000119105', '5743005', '783090002', '1230068002', '1231150005', '1230066003', '86923008', '765191009', '715989002', '15693761000119106', '15693721000119101', '231944006', '231933003', '419197009', '866099002', '719430008', '193413001', '15665881000119107', '341461000119103', '796522451000119103', '339381000119101', '339011000119105', '338371000119105', '337691000119103', '446021007', '724175002', '79385002', '60258001', '418054005', '418435001', '232042005', '80734006', '1187639002', '722380003', '1674008', '783246000', '312941005', '73431005', '1089801000119108', '1179283004', '723403008', '1172683008', '774212003', '773690008', '771342004', '778021002', '766987006', '22440001', '723408004', '1231232007', '45194000', '82710007', '82686002', '312898002', '16320791000119106', '16320871000119102', '16320831000119100', '445257004', '716170005', '232086000', '1285643003', '713457002', '1196923000', '1196922005', '698840003', '15736561000119108', '15736641000119105', '15736601000119108', '232041003', '15631051000119101', '15631011000119102', '25044007', '410471004', '1231227006', '15992671000119103', '15992631000119101', '128080005', '1231228001', '312925009', '78642008', '722054007', '314757003', '405809000', '763815000', '1255268002', '722055008', '722062004', '193687000', '722066001', '770723007', '771471002', '1231202004', '73221001', '339141000119108', '333531000119105', '276426004', '722108000', '15552004', '33382000', '870335005', '870332008', '870333003', '870330000', '870331001', '870329005', '404663008', '1269223003', '231938007', '679221000119104', '679241000119105', '15986831000119100', '15986871000119102', '719297006', '1833005', '723450004', '723452007', '773627004', '719296002', '724064004', '789008006', '870273007', '1231700006', '314544008', '410495002', '410497005', '410496001', '1231225003', '314547001', '231934009', '719282008', '763477007', '267613004', '80328002', '25913001', '773576000', '1220599002', '771263004', '726619004', '724016008', '312950007', '338421000119104', '332811000119106', '773771008', '1231751000', '2691000124105', '231930000', '723502001', '764452004', '723503006', '774152007', '770594005', '73119000', '57838006', '1010610007', '1231663000', '1172605003', '724001005', '1220597000', '15699281000119107', '15699201000119104', '15699241000119102', '715562001', '338021000119106', '338001000119102', '337991000119106', '337981000119108', '337971000119105', '332411000119108', '332391000119108', '332381000119105', '332371000119107', '332361000119101', '408847006', '408848001', '408849009', '408850009', '408851008', '870347004', '1231659007', '679701000119100', '679711000119102', '723999009', '15665841000119102', '335851000119101', '889967811000119101', '333781000119100', '333401000119104', '332761000119100', '332081000119107', '723499000', '1264000005', '419395007', '890423003', '193487008', '30080002', '312491004', '716663009', '721076000', '193410003', '723621000', '723612001', '718766002', '70099003', '415584007', '723582004', '231903005', '337521000119104', '331901000119107', '75315001', '717337001', '36276008', '27971006', '679231000119101', '679251000119107', '417065002', '416069001', '95794005', '24225004', '679881000119104', '679891000119101', '1208932005', '416913007', '1285322008', '85049009', '1177031006', '232057003', '514793471000119104', '232058008', '733110004', '312957005', '771235001', '317349009', '232113004', '771237009', '772224009', '715988005', '79665007', '718718009', '715426004', '718579008', '732246009', '715240000', '232054005', '232055006')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.77c42cf1-74bb-48d2-bd76-45237dae37cf"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_ophthalmic_disorder=Input(rid="ri.foundry.main.dataset.725cab03-9ce8-45c9-8531-f16501ea1ccd")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_ophthalmic_disorder A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.b9b1a407-81e4-4df6-b467-7789685a1b38"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_ophthalmic_disorder_data=Input(rid="ri.foundry.main.dataset.77c42cf1-74bb-48d2-bd76-45237dae37cf")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('Q12.1', 'A54.3', 'H13.1', 'H20.2', 'H02.3', 'Q12.4', 'Q11.0', 'Q10.2', 'Q12.0', 'Q10.1', 'L12', 'H13.3')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_ophthalmic_disorder_data
) as rare_ophthalmic_disorder_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.a6a85104-d74b-4b2d-b1ad-fcc2fd5a168a"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for " " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('1187563003', '753248161000119109', '719468005', '92894005', '75311005', '897530009', '75922002', '230502003', '1234911006', '722917001', '702360007', '1186656004', '54386000', '1279831004', '232442001', '765763007', '51523009', '253737007', '204550009', '9660004', '447810006', '447811005', '204552001', '890386005', '890387001', '890354000', '890355004', '204530005', '95467005', '427791009', '232441008', '47070001', '718714006', '720506002', '733069009', '763220008', '763129001', '1172604004', '726703000', '232328005', '1230014007', '712493008', '448548007', '763532008', '737580004', '1264005000', '771147003', '93623004', '724178000', '446079007', '232384005', '5645008', '724093004', '92503002', '1260199008', '70348004', '764097002', '764098007', '715529009', '719272007', '232330007', '768933005', '700489002', '723721007', '699802009', '770784003', '719305006', '715239002', '717799003', '350456001000119102', '102344001000119102', '722476007', '1167372000')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.12145cc5-5791-4c72-a787-27df781bdb08"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_otorhinolaryngologic_disease=Input(rid="ri.foundry.main.dataset.a6a85104-d74b-4b2d-b1ad-fcc2fd5a168a")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_otorhinolaryngologic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.138dd1f8-9ff0-452e-a385-6009d8acf048"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_otorhinolaryngologic_disease_data=Input(rid="ri.foundry.main.dataset.12145cc5-5791-4c72-a787-27df781bdb08")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('Q16.3', 'Q31.5', 'Q31.0', 'Q31.3', 'Q31.1', 'Q32.0')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_otorhinolaryngologic_disease_data
) as rare_otorhinolaryngologic_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.010aff06-3cfb-4bd2-a13c-a2f3977425e2"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_renal_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED'  and concept_code in ('236467001', '724099000', '81475007', '236538004', '368871000119106', '238009001', '238010006', '444749006', '733650000', '236468006', '253878003', '253879006', '770414008', '717766000', '717767009', '717768004', '1187124004', '65791008', '789660001', '778025006', '253880009', '765331004', '725393000', '703310005', '726018006', '707742001', '700107006', '700109009', '700111000', '700112007', '717791000', '1260181000', '717749002', '717187000', '368901000119106', '708127008', '29692004', '85223007', '236466005', '725592009', '37183000', '21952001', '42496002', '124274002', '1264001009', '717789008', '717790004', '444645005', '87235005', '722468005', '783620009', '236385009', '109477002', '717787005', '237886009', '725033008', '236460004', '226309007', '236478009', '783614008', '66451004', '818952002', '197601003', '236539007', '197626007', '445431000', '718141008', '707756004', '236535001', '722759007', '1217380005', '434061000124103', '32599008', '403732009', '402458002', '61165007', '368941000119108', '54627004', '836343001', '766937004', '721840000', '711151004', '724282009', '721173005', '722119002', '1260197005', '1260194003', '1260198000', '1187507004', '726082003', '702635003', '444558002', '1269270002', '722008003', '25646005', '721862000', '722457005', '782738008', '717267005', '446923008', '75888001', '236409000', '236410005', '1003367004', '1003368009', '1003387003', '726017001', '723409007', '236527004', '368921000119102', '723440000', '446989009', '446991001', '447335007', '368911000119109', '773647007', '768846004', '718192000', '773737004', '238007004', '368961000119107', '714814006', '723449004', '28770003', '17901006', '65520001', '40951006', '734990008', '828971000000101', '1269236003', '239932005', '43941006', '85880000', '91180009', '15689008', '703254001', '707747007', '368881000119109', '714813000', '236531005', '716200002', '402762007', '445119005', '133031000119106', '733096007', '717263009', '719839000', '418839003', '723373006', '1187460003', '726106004', '236713006' )
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.cb25c016-f953-4b64-a3b4-0989cbc7160b"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_renal_disease=Input(rid="ri.foundry.main.dataset.010aff06-3cfb-4bd2-a13c-a2f3977425e2")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_renal_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.6bc4da83-2cc6-4c12-99ce-2a7a4a81900f"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_renal_disease_data=Input(rid="ri.foundry.main.dataset.cb25c016-f953-4b64-a3b4-0989cbc7160b")
)
-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ( 'Q61.1', 'Q61.2', 'Q61.5')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_renal_disease_data
) as rare_renal_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.d04356a0-cc63-4df3-b3b8-d2d6e19394c4"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_respiratory_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('789574002', '236302005', '315345002', '733054008', '59903001', '184431000119108', '240741002', '187069002', '187027001', '58524006', '196046009', '196047000', '707541006', '674814021000119106', '370658281000119103', '352269591000119107', '9095002', '65102004', '37981002', '30188007', '722915009', '22607003', '10446001', '762270003', '707443007', '69339004', '720575002', '762618008', '1177120001', '67569000', '12088005', '3487004', '421047005', '722914008', '18121009', '1163150009', '28791000119105', '1163147006', '47938003', '840350008', '840351007', '708026002', '417688002', '240742009', '733171006', '240747003', '233615002', '26427008', '783182004', '233947005', '762269004', '762195006', '233646003', '708028001', '707442002', '57451009', '233692000', '190905008', '235978006', '86555001', '720401009', '86092005', '81423003', '8549006', '426705001', '430476004', '233810009', '233673002', '58554001', '30437004', '28085001', '271503005', '34286007', '50694005', '859041000000103', '707766007', '426437004', '233944003', '234161007', '715219001', '717331000', '18690003', '725052002', '76630008', '716088000', '63741006', '233613009', '408683000', '408688009', '400211001', '697897003', '697900005', '697899000', '233707008', '725415009', '724499007', '233629001', '1172606002', '697898008', '700250006', '40527005', '86204009', '233664005', '233811008', '724229002', '1197476009', '721804002', '1222678003', '1222677008', '707436001', '42402006', '254621001', '196067009', '721977007', '1204459002', '707433009', '206292002', '651000146102', '707441009', '762287001', '206359006', '707435002', '276545006', '282726006', '70073005', '707373004', '53926002', '870276004', '271504004', '1177059007', '415125002', '1208602000', '442094008', '38699009', '441590008', '111900000', '84753008', '195904005', '89687005', '276231004', '719282008', '233663004', '187066009', '88036000', '361208003', '276546007', '44833003', '187052004', '87153008', '233616001', '20953001', '708030004', '723829000', '697923008', '196151000', '196152007', '196153002', '707551007', '233614003', '718097008', '1177000004', '73995006', '45263007', '89420002', '33631007', '708025003', '233738009', '472827002', '129451001', '46775006', '233667003', '7377003', '233713004', '707510005', '716712004', '78887005', '398447004', '715882005', '1228876007', '721076000', '233943009', '782761005', '22482002', '836478002', '836479005', '762271004', '196027008', '37615000', '266370006', '14527007', '1260190007', '233666007')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.037aa8a7-c412-414d-b61a-e4187ce4bb45"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_respiratory_disease=Input(rid="ri.foundry.main.dataset.d04356a0-cc63-4df3-b3b8-d2d6e19394c4")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_respiratory_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.f6a5c2dd-ca5c-4b03-b0d8-348b87cc8bed"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_respiratory_disease_data=Input(rid="ri.foundry.main.dataset.037aa8a7-c412-414d-b61a-e4187ce4bb45")
)
-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data 
    where condition_source_value in ( 'J63.2', 'U04.9', 'I27.0', 'P27.1', 'J80', 'P24.0', 'P22.0', 'J67.0')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_respiratory_disease_data
) as rare_respiratory_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.5e1b59a0-b095-4d1c-b757-2a411fab086e"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for " Rare_skin_disease" rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification (13370002) '13370002',

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('719595002', '13370002','2772003', '201160005', '8691004', '1254908004', '403404004', '1254861008', '77039003', '403401007', '403786001', '733638006', '709416009', '238949006', '402842008', '718633009', '83839005', '239069005', '238872007', '111029001', '238640007', '400018004', '400085009', '239089006', '776417008', '239098009', '200999007', '201015007', '52636001', '84625002', '1251367000', '1254886004', '702617007', '402326008', '34748004', '238942002', '1254885000', '403411000', '29756008', '702810006', '783205005', '720980004', '764849002', '49465005', '774210006', '720493003', '718631006', '201000006', '707247006', '239013001', '720494009', '784351000', '1228843008', '403549004', '403551000', '403548007', '403552007', '403550004', '838362006', '403553002', '723554006', '720500008', '403757004', '403763008', '403756008', '720499004', '1169365006', '715963002', '25858008', '2736005', '238619006', '238622008', '725148000', '716105001', '403794008', '783136007', '1231284001', '254164007', '719518004', '403811007', '784381008', '778068007', '890235002', '763768001', '403795009', '782878007', '403812000', '725588002', '403622009', '69488000', '255192005', '19719003', '34250006', '267800008', '76092003', '15632131000119104', '717941005', '46459009', '703531009', '11160000', '402442000', '6111009', '399945005', '26374003', '30657009', '65747008', '238928005', '402439006', '109250009', '238927000', '238621001', '239073008', '238618003', '238620000', '1251401000', '711154007', '1208477000', '239152005', '239153000', '239144007', '773691007', '403799003', '1208936008', '1197059004', '724277002', '53748002', '722391005', '403281007', '239072003', '703504006', '254231002', '51156002', '278098005', '128865003', '718373005', '718634003', '128862000', '128864004', '19726003', '111388003', '403399001', '403398009', '254222002', '403400008', '238883003', '48611009', '784339002', '111196000', '239088003', '774209001', '397014001', '721096008', '778062008', '239145008', '79291003', '403498005', '403501005', '403496009', '403500006', '403499002', '700269001', '403494007', '403495008', '403497000', '700334001', '717258005', '403502003', '41495000', '111389006', '75875004', '2689001', '403629000', '414061000', '403632002', '403633007', '1251421004', '403626007', '403631009', '403630005', '403670003', '403625006', '403609001', '702809001', '702811005', '239082002', '403809003', '722436002', '238832003', '254739004', '49428008', '238905009', '238931006', '402435000', '19138001', '402450009', '402448001', '402449009', '402447006', '402451008', '403810008', '773501006', '773503009', '716699004', '254179000', '398071000', '716700003', '254177003', '254180002', '723308003', '716701004', '400142003', '239071005', '238733003', '254664008', '58872001', '16898231000119107', '763767006', '254161004', '239062001', '239063006', '1179293006', '70041004', '783615009', '403210001', '774066000', '79468000', '1220590003', '239139000', '782823001', '765195000', '764523004', '402463003', '766888002', '763714006', '403930008', '403825008', '1162852008', '403793002', '763368004', '715630006', '15632091000119101', '15632051000119106', '442528007', '73692007', '403783009', '774065001', '400115004', '789157007', '789159005', '789160000', '789161001', '764963007', '778051008', '254820002', '53593008', '717055000', '782946000', '766928004', '90496008', '110980006', '238763007', '1240462005', '1240463000', '718749004', '238612002', '238613007', '238632001', '718215008', '41352000', '1254946006', '1254947002', '403521006', '205548006', '37702000', '238835001', '733467001', '733469003', '771306007', '723362004', '717256009', '724350009', '716774008', '403442005', '717228004', '771300001', '403774004', '9311003', '86081009', '771145006', '711159002', '111030006', '91623008', '860796007', '403784003', '403492006', '37548006', '783555001', '723363009', '763404001', '254169002', '403782004', '254170001', '763401009', '238775002', '238821003', '402717008', '721313009', '254146000', '238616004', '399904002', '399995006', '402782006', '238901000', '1177176009', '403988009', '1177178005', '254192002', '717963001', '1260463008', '1187178004', '709413001', '110982003', '400140006', '254196004', '277812008', '1254920007', '238615000', '400031009', '255013004', '414552005', '717183001', '239064000', '763775000', '238626006', '52983002', '73860009', '238836000', '1271009', '724206005', '1222645005', '403777006', '1260467009', '722675000', '773698001', '719432000', '773692000', '703541007', '1230026002', '771184001', '763792009', '773700005', '64540004', '721180007', '238653005', '717061002', '403803002', '403395007', '773697006', '95330001', '44509000', '403785002', '22784002', '1231148002', '38692000', '403652001', '403661001', '238899009', '71404003', '1187628000', '254168005', '402437008', '254186008', '400100000', '238897006', '254191009', '254187004', '201048007', '238735005', '15084002', '200941006', '200942004', '239888002', '768962006', '400171002', '773406003', '254234005', '37770007', '239142006', '1172585006', '866046008', '707986004', '403410004', '400204000', '733028000', '254659009', '238902007', '24559001', '402340009', '715535009', '9418005', '56391002', '66350002', '16238009', '404164003', '404165002', '762543009', '424114000', '312514006', '1141661004', '1208340009', '773986009', '239140003', '400138001', '717257000', '254163001', '7806002', '403610006', '723444009', '314757003', '403554008', '765146000', '715632003', '722057000', '722058005', '722059002', '254817005', '402441007', '402444004', '402446002', '402440008', '718471008', '361212009', '39427000', '403802007', '403801000', '403787005', '403790004', '239076000', '722205008', '785725008', '724224007', '783014007', '40158001', '1208479002', '771473004', '717259002', '765221009', '783013001', '1254862001', '403989001', '418186002', '29834003', '402438003', '238940005', '36739006', '35154004', '402718003', '81285006', '238937005', '49420001', '715840006', '77333008', '773984007', '5387003', '1081501000119107', '1081471000119101', '1081541000119109', '1081511000119105', '687571000119101', '21926007', '717360009', '42829009', '67817003', '716194005', '200948000', '3755001', '1142046003', '1237509001',  '128458002', '772126000', '1252747005', '193193007', '80432009', '718218005', '239118007', '1258980000', '403397004', '403325003', '128873007', '238829001', '1228842003', '765135003', '716704007', '778044004', '1268699008', '770567006', '254193007', '765141005', '239070006', '254678009', '109253006', '402748000', '238731001', '252246005', '1254939002', '1254936009', '764105002', '1237573001', '62144003', '717184007', '765096001', '3533007', '27520001', '785724007', '64036004', '723500009', '725407006', '33760009', '239133004', '716772007', '721904001', '403493001', '63450009', '774208009', '110983008', '95323007', '402468007', '252997008', '782910009', '718632004', '238947008', '238898001', '95334005', '774211005', '723716009', '111303009', '778010006', '397013007', '403409009', '404101009', '719255000', '719306007', '724833000', '73442001', '124911000119100', '768946000', '765187004', '764958008', '239891002', '403489007', '403490003', '25147002', '403217003', '403522004', '402747005', '403216007', '239085000', '717041008', '239108002', '400000002', '403623004', '19087001', '274083001', '402744003', '402359006', '768961004', '723553000', '723544007', '766812005', '274899008', '19604005', '61778004', '238719003', '26336006', '51057008', '400126005', '698253007', '254230001', '254676008', '294705005', '763475004', '389203001', '719835006', '239124001', '764108000', '238875009', '399970005', '44600005', '719819004', '43477006', '1073003', '25784009', '68637004', '56048001', '42530008', '36454001', '88877002', '1010628009', '72523005', '717224002', '82342003')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.f32a4831-70b4-474a-a813-e7296cc2ca13"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_skin_disease=Input(rid="ri.foundry.main.dataset.5e1b59a0-b095-4d1c-b757-2a411fab086e")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_skin_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.4eede74d-647a-4c28-b104-51272c043d20"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_skin_disease_data=Input(rid="ri.foundry.main.dataset.f32a4831-70b4-474a-a813-e7296cc2ca13")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD ('M72.2', removed for plantar fasci)

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data 
    where condition_source_value in ( 'Q80.1', 'M72.2','L93.1', 'L10.0',  'L13.0', 'L44.0', 'L40.1', 'G51.2', 'Q80.3', 'Q80.4', 'L98.2', 'Q82.1', 'L57.1', 'L66.2', 'L66.3', 'L98.3', 'L72.2', 'L85.0', 'L68.1', 'L66.1', 'Q84.3', 'L43.1', 'M35.6', 'L92.1', 'L95.0', 'L12.3', 'L13.1', 'L95.1', 'L94.0', 'Q81.1', 'L10.1', 'E52', 'L51.2', 'L92.2')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_skin_disease_data
) as rare_skin_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.2eb34aef-9eea-426c-a16e-5ed948b92be3"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_surgical_thoracic_disease" rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('8051000119105', '413577001', '15966941000119103', '15966981000119108', '16206181000119108', '16206221000119100', '40017005', '12242151000119106', '15966901000119100', '2040007', '414848001', '15968581000119104', '15968701000119102', '12242191000119101', '15966861000119106', '211236007', '128210009', '415714003', '128211008', '25981000119102')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.bbff32e8-d029-464e-b8e6-9585e36007aa"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_surgical_thoracic_disease=Input(rid="ri.foundry.main.dataset.2eb34aef-9eea-426c-a16e-5ed948b92be3")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_surgical_thoracic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.6771f87a-a36b-4e4d-bdff-7993a5a7fffd"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_surgical_thoracic_disease_data=Input(rid="ri.foundry.main.dataset.bbff32e8-d029-464e-b8e6-9585e36007aa")
)
-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, no icd10 codes
SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM rare_surgical_thoracic_disease_data

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.07752fd1-ea79-467f-b606-a71299e5b03f"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for " Rare_systemic_or_rheumatologic_disease" rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('425879009', '371627004', '703802001', '703801008', '241955009', '75053002', '402856005', '1155919006', '81077008', '1148763004', '18192007', '195528001', '312591002', '194709000', '64072006', '15676002', '84871007', '234529004', '236503001', '238674006', '403486000', '402425006', '239920006', '328611000119105', '783160006', '1231149005', '23132008', '1228881003', '402453006', '426598005', '785808002', '1144986007', '445187004', '838366009', '1144974009', '55711009', '402369000', '1222681008', '1222679006', '722292000', '773333003', '1251499005', '1144919009', '1144914004', '1197742004', '403443000', '239922003', '239921005', '310701003', '57484009', '53485006', '54034003', '21542005', '3275009', '58144006', '818950005', '719096006', '238985006', '239889005', '838314000', '237900002', '717043006', '771187008', '75403004', '720609003', '609329007', '1186720006', '230732009', '111936002', '1212005', '239826001', '1204420006', '234530009', '238678009', '236744002', '402338004', '778022009', '1255121003', '405810005', '763318007', '720751000', '31848007', '62382002', '190815001', '718217000', '239926000', '55941000', '1230290005', '784339002', '724780002', '724781003', '724783000', '1237225007', '1144925008', '15960021000119107', '16055631000119106', '15993551000119100', '16052791000119105', '988081000000103', '80258006', '61458006', '54912002', '22888007', '239900005', '201436003', '239799007', '733457006', '720858001', '715318006', '1287094005', '25606004', '720859009', '718211004', '720860004', '720861000', '773276004', '233771008', '403735006', '403634001', '238476000', '8090002', '82275008', '240120003', '699537002', '200951007', '1156819003', '1156817001', '15123008', '71322004', '1162808000', '238687000', '12579009', '24129002', '57160007', '1162362005', '1162364006', '399964004', '403487009', '7021009', '239939001', '239938009', '89681000119101', '50581000', '195353004', '235000001', '232460001', '232369001', '1231671001', '239936008', '699861000', '37061001', '39795003', '4416007', '32599008', '402458002', '197368002', '988111000000106', '1230015008', '427167008', '234619000', '234620006', '1187119002', '1254916008', '233744008', '127217009', '721226005', '30652003', '239945009', '402373002', '1144977002', '402368008', '281357005', '766704005', '722870008', '191306005', '1187508009', '10743271000119103', '1255207005', '1186834004', '1187507004', '1187510006', '762282007', '1264005000', '773328002', '711286009', '310931000119102', '311011000119104', '773732005', '766711009', '311671000119100', '1144920003', '410801005', '410800006', '410798004', '410799007', '738526005', '1144915003', '239802003', '239803008', '239808004', '410797009', '410796000', '722020006', '399894006', '234527002', '1217370006', '118614007', '404160007', '707431006', '417152008', '707432004', '232458003', '93133006', '93134000', '93135004', '1255740000', '1255742008', '1255885008', '93139005', '1255741001', '1255813007', '93140007', '238681004', '239935007', '239886003', '299276009', '84241008', '446263001', '238676008', '196136009', '196138005', '77753005', '19682006', '239888002', '64757003', '430478003', '1156801007', '238677004', '238850005', '703540008', '404167005', '75073007', '11683003', '39326005', '236459009', '31595004', '60871005', '423352002', '57201002', '19346006', '234035006', '1003407000', '233743002', '1144805008', '7826003', '398049005', '718551002', '716868003', '1255116001', '402339007', '702449004', '232368009', '234528007', '111292008', '402662002', '774084003', '774083009', '774082004', '95609003', '763839005', '774080007', '295101000119105', '295111000119108', '230193008', '1264006004', '783146009', '54072008', '870350001', '402712002', '234526006', '235066005', '234531008', '765435009', '870334009', '238680003', '403702001', '724603009', '87442008', '25380002', '1197594000', '50869007', '1156765006', '1156766007', '95412009', '445476000', '445304002', '323621000119108', '323691000119105', '445266000', '15664881000119106', '773646003', '155441006', '239927009', '239925001', '31384009', '239899000', '1144944001', '239898008', '239946005', '770903003', '239912009', '402454000', '773644000', '444133002', '28122003', '697922003', '697921005', '24369008', '1256081007', '882271000000104', '785724007', '1258979003', '1256078002', '1256079005', '724015007', '110041000119104', '67224007', '38933006', '72275000', '232439007', '236502006', '702575003', '715401008', '46826000', '57803009', '123950001', '58718002', '240041006', '24363009', '7548000', '1156778006', '1156779003', '1156777001', '1156774008', '60684003', '400127001', '361198004', '361197009', '234524009', '195033009', '192673008', '193251003', '193195000', '31541009', '91259005', '9529007', '238679001', '72470008', '111937006', '735433009', '310607007', '1231657009', '187233002', '707238003', '1231658004', '54515008', '425384007', '233772001', '231799005', '763630007', '402415001', '37821003', '402380000', '402457007', '1230323000', '34287003', '68815009', '73286009', '4676006', '76521009', '36402006', '52042003', '11013005', '716745004', '17363001', '1251488008', '726078000', '190923000', '233767005', '233768000', '233769008', '233770009', '773702002', '711164003', '80941006', '1256045009', '95644001', '698694005', '403488004', '397856003', '239890001', '309762007', '201796004', '128460000', '443872005', '128461001', '298285004', '1187615007', '359789008', '402379003', '718614004', '400130008', '52403007', '403833009', '1256055008', '402370004', '239918008', '402416000', '17025000', '724063005', '234020005', '402371000', '202435002', '202430007', '202442002', '202437005', '202436001', '202451005', '202427000', '202453008', '202452003', '202429002', '312820003', '202439008', '202432004', '202441009', '202444001', '202424007', '202434003', '202448003', '202449006', '202909008', '202446004', '202425008', '312819009', '202438000', '771236000', '237877004', '67202007' )
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.1c036dc6-484d-4ab6-93b9-e3849143e3a1"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_systemic_or_rheumatologic_disease=Input(rid="ri.foundry.main.dataset.07752fd1-ea79-467f-b606-a71299e5b03f")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_systemic_or_rheumatologic_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date;

/*
SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value
FROM rare_systemic_or_rheumatologic_disease A
INNER JOIN  condition_occurrence B 
ON A.concept_id = B.condition_concept_id;
*/

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.350ba113-30fe-4ffd-9ca9-eb24cfe89fce"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_systemic_or_rheumatologic_disease_data=Input(rid="ri.foundry.main.dataset.1c036dc6-484d-4ab6-93b9-e3849143e3a1")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ( 'Q87.4', 'M35.2', 'M33.2', 'M31.0', 'N08.5', 'M30.1', 'M31.7', 'M31.3', 'M31.4', 'M30.3', 'M11.1', 'M30.0', 'M35.1', 'M32.0', 'M12.4', 'M86.3', 'M06.1', 'M35.0', 'M02.3', 'M94.1', 'M12.2', 'I73.1', 'M08.4', 'M08.2', 'M33.0')

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_systemic_or_rheumatologic_disease_data
) as rare_systemic_or_rheumatologic_disease_data_icd10 ;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.28543575-8bfd-4955-9308-bd192e76d4b4"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_transplantation_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification

SELECT *
FROM concept
where vocabulary_id = 'SNOMED' and concept_code in ('233844002', '431456004', '431186002', '433804007', '432777003', '431507002', '433809002', '236572007', '121121000119106', '236582008', '431862001', '432843002', '434238001', '431222008', '431223003', '433592008', '236574008', '236575009', '236576005', '236577001', '853021000000108', '852981000000100', '444855007', '16058791000119108', '16058751000119103', '234520000', '234519006', '805261000000101', '762618008', '233934000', '233933006', '121131000119109', '128631000119109', '431953002', '431896008', '434270001', '432908002', '432958009', '434271002', '236578006', '236579003', '236580000', '236581001', '1144941009', '1269145009', '1156197003', '92831004', '13160009', '33167004', '44165003', '79369007', '233979001', '314002005', '420505005', '421187003', '63541000119109', '314552006', '314551004', '314760005', '314553001', '95742008', '314554007', '348741000119101', '348291000119100', '420571002', '792842004', '112621000119104', '426136000', '236586006', '1264001009', '236585005', '234522008', '429490004', '16370261000119105', '483082881000119106', '564989741000119102', '428103008', '429257001', '429450002', '427927008', '427928003', '429451003', '429054002', '213086000', '234001008', '720587009', '722956007', '236436003', '236583003', '12200321000119107', '213085001', '1251346000', '429514007', '213152006', '213151004', '234004000', '234077006', '1230342001', '432782005', '432773004', '433600001', '432772009', '432774005', '434202008', '236571000', '427889009', '428575007', '213127009', '12224461000119108', '12224501000119108', '712072191000119105', '156077081000119105', '145781000119106', '722958008', '213150003', '235910007', '235912004', '213153001', '235911006', '312603000', '1153358006', '122491000119108', '122511000119103', '122531000119108', '122521000119105', '122501000119101', '254290004', '29859007', '445964006', '129781000119105', '236584009', '236614007', '762316003', '233634002', '1255627000', '703048006', '773275000', '445260006', '445261005', '254289008', '277011002', '433087001', '236569000', '427435004', '722957003', '1255577005', '1197150002', '707148007', '213088004', '432265007', '431505005', '431506006', '236570004', '847791000000101', '234008002', '234079009', '847811000000100', '429362002', '213192008', '1256047001', '233971003', '234066000', '847881000000107', '864271000000105', '864311000000105', '262945004', '269295009', '213148006', '16058871000119104', '16058711000119104', '236587002', '236588007', '236589004', '16058671000119103', '16058831000119102', '713825007', '277010001', '843691000000100', '844661000000109', '236573002')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.ece94543-a09c-4c0a-8384-46d8c9f3d844"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_transplantation_disease=Input(rid="ri.foundry.main.dataset.28543575-8bfd-4955-9308-bd192e76d4b4")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_transplantation_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.0a7ba25e-f224-43e0-9a59-e725b9a89e21"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_transplantation_disease_data=Input(rid="ri.foundry.main.dataset.ece94543-a09c-4c0a-8384-46d8c9f3d844")
)

-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, NO icd10 code

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM rare_transplantation_disease_data

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.4ef44347-ec7e-4777-8773-45413d980714"),
    concept=Input(rid="ri.foundry.main.dataset.5cb3c4a3-327a-47bf-a8bf-daf0cafe6772")
)
-- Following code is for "Rare_urogenital_disease " rare diseases with snomed-ct codes and its descendent ids linearization ohdsi classification (Chronic interstitial cystitis : '197834003', need to remove due to incidence filter)

SELECT *
FROM concept
where vocabulary_id = 'SNOMED'  and concept_code in ( '36139001', '717459000', '763716008', '700242002', '367661000119102', '441575009', '253904001', '429233001', '442584007')
ORDER BY concept_name;

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.72104fee-3b14-4bca-910d-006624d2f821"),
    Covid_cohort_rwe=Input(rid="ri.foundry.main.dataset.9743ff51-555f-4eb9-98dd-789b05f159b4"),
    condition_occurrence=Input(rid="ri.foundry.main.dataset.900fa2ad-87ea-4285-be30-c6b5bab60e86"),
    rare_urogenital_disease=Input(rid="ri.foundry.main.dataset.4ef44347-ec7e-4777-8773-45413d980714")
)
-- Rare disease started before covid diagnosis date 

SELECT A.concept_id, A.concept_code, B.person_id , B.condition_end_date, B.condition_start_date, B.data_partner_id, B.condition_concept_id,B.condition_concept_name, B.condition_source_concept_name, B.condition_source_value, C.person_id as CPID, C.COVID_first_poslab_or_diagnosis_date
FROM rare_urogenital_disease A
JOIN
    condition_occurrence B ON A.concept_id = B.condition_concept_id
JOIN
    Covid_cohort_rwe C ON B.person_id = C.person_id
WHERE B.condition_start_date < C.COVID_first_poslab_or_diagnosis_date

@transform_pandas(
    Output(rid="ri.foundry.main.dataset.248cf8e8-e40e-458d-8201-a890b8c58b50"),
    Rd_before_covid_icd10_data=Input(rid="ri.foundry.main.dataset.634b3ba7-6196-425d-b2de-fa7f18ff5572"),
    rare_urogenital_disease_data=Input(rid="ri.foundry.main.dataset.72104fee-3b14-4bca-910d-006624d2f821")
)
-- "Rd_before_covid_icd10_data" table is created based on ICD10 codes which is pre-processed by excluding HPO, duplicates, one to many mapping of RD

SELECT person_id, data_partner_id, condition_start_date, condition_end_date, condition_concept_name, condition_concept_id
FROM (
    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,condition_concept_name,condition_source_value
    FROM Rd_before_covid_icd10_data
    where condition_source_value in ('Q62.2', 'N30.1' )

    UNION ALL

    SELECT person_id,condition_start_date,condition_end_date,data_partner_id,condition_concept_id,
    condition_concept_name, NULL AS condition_source_value
    FROM rare_urogenital_disease_data
) as rare_urogenital_disease_data_icd10 ;

